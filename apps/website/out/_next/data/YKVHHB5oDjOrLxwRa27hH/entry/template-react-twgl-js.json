{"pageProps":{"entry":{"head":{"slug":"template-react-twgl-js","tags":["engineering"],"created":"2022-12-31T16:42:00.000Z","updated":"2023-01-04T06:36:00.000Z","title":"あらゆるものから逃げるReact+WebGLテンプレートを作った","coverImageUrl":null},"body":{"content":[{"object":"block","id":"b6aea1c2-e4a3-4f56-a35d-ba97815945c7","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2022-12-31T16:42:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"table_of_contents","table_of_contents":{"color":"gray"}},{"object":"block","id":"dc0a2cbc-7fcb-4d4e-acd6-4ad581bf9cd0","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2022-12-31T16:42:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"React+WebGL で SPA の何かしらを作る際のテンプレートを作りました。あらゆるものから逃げます。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"React+WebGL で SPA の何かしらを作る際のテンプレートを作りました。あらゆるものから逃げます。","href":null}],"color":"default"}},{"object":"block","id":"63a90360-8a04-4eb5-961d-e6fd96a23926","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2023-01-04T06:35:00.000Z","last_edited_time":"2023-01-04T06:36:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"image","image":{"caption":[{"type":"text","text":{"content":"プレビューのトップページ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"プレビューのトップページ","href":null}],"type":"file","file":{"url":"https://s3.us-west-2.amazonaws.com/secure.notion-static.com/4ce575f1-4172-4bba-8a4d-3245e881d950/react-twgl.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20230108%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230108T071856Z&X-Amz-Expires=3600&X-Amz-Signature=0cb14a3d1dbdbdf62ea203c9fcfd8a90ad11c13d0744c631192805a4523769f6&X-Amz-SignedHeaders=host&x-id=GetObject","expiry_time":"2023-01-08T08:18:56.651Z"}}},{"object":"block","id":"756a413d-eda1-44f0-8748-990b9a3946e8","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2023-01-04T06:35:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"リポジトリは","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"リポジトリは","href":null},{"type":"text","text":{"content":"こちら","link":{"url":"https://github.com/shuta13/react-twgl-boilerplate"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"こちら","href":"https://github.com/shuta13/react-twgl-boilerplate"},{"type":"text","text":{"content":"。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"。","href":null}],"color":"default"}},{"object":"block","id":"1f2d730a-9c9e-43a5-b882-be6f518a5d0b","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2023-01-04T06:35:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"Netlify にプレビュー放り投げたのでこちらもどうぞ。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Netlify にプレビュー放り投げたのでこちらもどうぞ。","href":null}],"color":"default"}},{"object":"block","id":"9c597469-f991-4a9a-a5d9-7d4c3dbd17a1","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2022-12-31T16:42:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"https://did0es-react-twgl-boilerplate.netlify.app","link":{"url":"https://did0es-react-twgl-boilerplate.netlify.app/"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"https://did0es-react-twgl-boilerplate.netlify.app","href":"https://did0es-react-twgl-boilerplate.netlify.app/"}],"color":"default"}},{"object":"block","id":"f88f8331-6323-49b6-8037-641240942ae9","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2023-01-02T13:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"heading_1","heading_1":{"rich_text":[{"type":"text","text":{"content":"構成","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"構成","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"60bd02b4-ce50-4668-b121-87d0e4bbbfe9","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2022-12-31T16:42:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"React を使いつつ、CRA を使わず webpack のコンフィグを書いています(どうせ eject するので webpack から書いた)。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"React を使いつつ、CRA を使わず webpack のコンフィグを書いています(どうせ eject するので webpack から書いた)。","href":null}],"color":"default"}},{"object":"block","id":"2eeba0f1-e080-4d99-bd6c-86d0adea4185","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2022-12-31T16:42:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"React (17.x)","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"React (17.x)","href":null}],"color":"default"}},{"object":"block","id":"de206faa-e338-4532-9942-8f09ccae3e7f","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2022-12-31T16:42:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"Webpack (5.x)","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Webpack (5.x)","href":null}],"color":"default"}},{"object":"block","id":"6c0202b4-33a8-46d1-92a7-66c486c8c83f","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2022-12-31T16:42:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"Babel (17.x)","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Babel (17.x)","href":null}],"color":"default"}},{"object":"block","id":"dc4ea7c3-d8ab-4f52-9e30-30634fbd7dac","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2022-12-31T16:42:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"TypeScript (4.x)","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"TypeScript (4.x)","href":null}],"color":"default"}},{"object":"block","id":"59c2274b-3eb5-4c77-b328-c770b3ad4311","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2022-12-31T16:42:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"Linaria","link":{"url":"https://github.com/callstack/linaria#readme"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Linaria","href":"https://github.com/callstack/linaria#readme"},{"type":"text","text":{"content":" (2.x)","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" (2.x)","href":null}],"color":"default"}},{"object":"block","id":"33b2637a-fc99-44ab-ab5f-39031f01964f","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2022-12-31T16:42:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"Universal Router","link":{"url":"https://github.com/kriasoft/universal-router#readme"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Universal Router","href":"https://github.com/kriasoft/universal-router#readme"},{"type":"text","text":{"content":" (9.x)","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" (9.x)","href":null}],"color":"default"}},{"object":"block","id":"f2ae922c-b9cb-47d3-aa0b-b86086fe4bbd","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2022-12-31T16:42:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"TWGL.js","link":{"url":"https://github.com/greggman/twgl.js#readme"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"TWGL.js","href":"https://github.com/greggman/twgl.js#readme"},{"type":"text","text":{"content":" (4.x)","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" (4.x)","href":null}],"color":"default"}},{"object":"block","id":"e82e5004-ae7b-4657-ad26-629fa5006cab","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2023-01-02T13:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"heading_1","heading_1":{"rich_text":[{"type":"text","text":{"content":"何から逃げたのか","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"何から逃げたのか","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"f81db6c8-def2-4547-af27-e37535413dc4","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2022-12-31T16:42:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"まず前提として純粋なSPAを作りたいと思ったので、 Next.js は使わない方針でいきました。  Next.js は SSG/SSR するときの踏み台にしたい気持ちがあります。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"まず前提として純粋なSPAを作りたいと思ったので、 Next.js は使わない方針でいきました。  Next.js は SSG/SSR するときの踏み台にしたい気持ちがあります。","href":null}],"color":"default"}},{"object":"block","id":"41f79005-fa27-4289-86a8-1e68e4cf134a","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2022-12-31T16:42:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"以下のものから逃げました。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"以下のものから逃げました。","href":null}],"color":"default"}},{"object":"block","id":"70a0b022-0f24-4cda-b8cc-37df4cd33cd3","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2022-12-31T16:42:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":true,"archived":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"react-router","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"react-router","href":null}],"color":"default"}},{"object":"block","id":"b37f08f0-1c73-4aa1-9844-f8aae963a673","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2022-12-31T16:42:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":true,"archived":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"three.js","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"three.js","href":null}],"color":"default"}},{"object":"block","id":"ab38d27d-e3c2-4701-a347-9e74193027b2","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2022-12-31T16:42:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":true,"archived":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"CSS Modules, styled-component","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"CSS Modules, styled-component","href":null}],"color":"default"}},{"object":"block","id":"f6a38cca-d720-4089-a34e-4cbafea296d4","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2023-01-02T13:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"heading_1","heading_1":{"rich_text":[{"type":"text","text":{"content":"逃げた理由","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"逃げた理由","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"c8774cfd-84d1-4c88-a79f-9720da308214","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2023-01-02T13:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"react-router","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"react-router","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"8f59e92c-143b-4d15-9fd9-8456b9404974","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2022-12-31T16:42:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"react-rouer は使う時に手の届かないところがあるとか、破壊的変更を繰り返しているのでついて行くのに疲れたからといった感じです。あとは universal-router を試してみたかった気持ちもあります。SPA でページ遷移を表現するには history とか location 周辺を自分で書く必要があるので、そういった部分の学びになりました。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"react-rouer は使う時に手の届かないところがあるとか、破壊的変更を繰り返しているのでついて行くのに疲れたからといった感じです。あとは universal-router を試してみたかった気持ちもあります。SPA でページ遷移を表現するには history とか location 周辺を自分で書く必要があるので、そういった部分の学びになりました。","href":null}],"color":"default"}},{"object":"block","id":"83198e66-8ad5-458d-8b1d-b567f73d538c","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2022-12-31T16:42:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"完成したものが以下のリンクから見れます。isomorphic さはそこまで求めていなかったのですが、path-to-regexp でかなりシンプルな Router ということで使い勝手が良さそうというのが所感です。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"完成したものが以下のリンクから見れます。isomorphic さはそこまで求めていなかったのですが、path-to-regexp でかなりシンプルな Router ということで使い勝手が良さそうというのが所感です。","href":null}],"color":"default"}},{"object":"block","id":"eb02148a-9072-4b1e-82ec-e802b1e9f9bb","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2022-12-31T16:42:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"react-twgl-boilerplate/src/routes","link":{"url":"https://github.com/shuta13/react-twgl-boilerplate/tree/main/src/routes"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"react-twgl-boilerplate/src/routes","href":"https://github.com/shuta13/react-twgl-boilerplate/tree/main/src/routes"}],"color":"default"}},{"object":"block","id":"562bfbd9-389e-4739-b931-283ca32d0df7","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2023-01-02T13:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"three.js","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"three.js","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"b2d64a5d-2cc3-4b1d-8d8d-20d53fa497f6","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2022-12-31T16:42:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"以下のように非常に苦しみました。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"以下のように非常に苦しみました。","href":null}],"color":"default"}},{"object":"block","id":"38bffe31-1045-41a3-b42c-292c1361be36","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2022-12-31T16:42:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"<blockquote class=\"twitter-tweet\"><p lang=\"und\" dir=\"ltr\">... <a href=\"","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"<blockquote class=\"twitter-tweet\"><p lang=\"und\" dir=\"ltr\">... <a href=\"","href":null},{"type":"text","text":{"content":"https://t.co/0q4W6PPK3K","link":{"url":"https://t.co/0q4W6PPK3K"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"https://t.co/0q4W6PPK3K","href":"https://t.co/0q4W6PPK3K"},{"type":"text","text":{"content":"\">","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"\">","href":null},{"type":"text","text":{"content":"pic.twitter.com/0q4W6PPK3K","link":{"url":"http://pic.twitter.com/0q4W6PPK3K"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"pic.twitter.com/0q4W6PPK3K","href":"http://pic.twitter.com/0q4W6PPK3K"},{"type":"text","text":{"content":"</a></p>— Shuta (@did0es) <a href=\"","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"</a></p>— Shuta (@did0es) <a href=\"","href":null},{"type":"text","text":{"content":"https://twitter.com/did0es/status/1355506728507371520?ref_src=twsrc^tfw","link":{"url":"https://twitter.com/did0es/status/1355506728507371520?ref_src=twsrc%5Etfw"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"https://twitter.com/did0es/status/1355506728507371520?ref_src=twsrc^tfw","href":"https://twitter.com/did0es/status/1355506728507371520?ref_src=twsrc%5Etfw"},{"type":"text","text":{"content":"\">January 30, 2021</a></blockquote>","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"\">January 30, 2021</a></blockquote>","href":null}],"color":"default"}},{"object":"block","id":"59821e75-ebd5-4776-bbef-cc7319e158ca","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2022-12-31T16:42:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"バンドルサイズを減らそうと思ったのですが tree shaking がまともに出来ない","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":true,"underline":false,"code":false,"color":"default"},"plain_text":"バンドルサイズを減らそうと思ったのですが tree shaking がまともに出来ない","href":null},{"type":"text","text":{"content":" webpack の plugin で tree shaking は出来るみたいなんですが、平面に GLSL 描画するだけにしか three の用途がなかったので、もう少し軽量な TWGL に逃げることにしました。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" webpack の plugin で tree shaking は出来るみたいなんですが、平面に GLSL 描画するだけにしか three の用途がなかったので、もう少し軽量な TWGL に逃げることにしました。","href":null}],"color":"default"}},{"object":"block","id":"ff2e02f6-a2f3-4c60-b8ce-b71a7f2aa77d","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2022-12-31T16:42:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"以下は React で TWGL.js を使う際のコードです。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"以下は React で TWGL.js を使う際のコードです。","href":null}],"color":"default"}},{"object":"block","id":"077bbe5f-fbd5-4afe-8bef-71add5dd70f1","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2022-12-31T16:42:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"// sourced from <http://twgljs.org/examples/tiny.html>\n\nimport {\n  createBufferInfoFromArrays,\n  createProgramInfo,\n  drawBufferInfo,\n  resizeCanvasToDisplaySize,\n  setBuffersAndAttributes,\n  setUniforms,\n} from 'twgl.js';\nimport { css } from '@linaria/core';\n\nexport const Canvas: React.FC = () => {\n  const onCanvasLoaded = (element: HTMLCanvasElement) => {\n    if (!element) return;\n\n    const gl = element.getContext('webgl');\n\n    if (gl == null) return;\n\n    const programInfo = createProgramInfo(gl, [\n      require('./shaders/vertex.glsl').default,\n      require('./shaders/fragment.glsl').default,\n    ]);\n\n    const arrays = {\n      position: [-1, -1, 0, 1, -1, 0, -1, 1, 0, -1, 1, 0, 1, -1, 0, 1, 1, 0],\n    };\n    const bufferInfo = createBufferInfoFromArrays(gl, arrays);\n\n    function render(time: number) {\n      if (!gl?.canvas) return;\n\n      resizeCanvasToDisplaySize(gl.canvas as HTMLCanvasElement);\n      gl.viewport(0, 0, gl.canvas.width, gl.canvas.height);\n\n      const uniforms = {\n        time: time * 0.001,\n        resolution: [gl.canvas.width, gl.canvas.height],\n      };\n\n      gl.useProgram(programInfo.program);\n      setBuffersAndAttributes(gl, programInfo, bufferInfo);\n      setUniforms(programInfo, uniforms);\n      drawBufferInfo(gl, bufferInfo);\n\n      requestAnimationFrame(render);\n    }\n    requestAnimationFrame(render);\n  };\n  return <canvas className={wrap} ref={onCanvasLoaded} />;\n};\n\nconst wrap = css`\n  width: 100%;\n`;\n\n","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"// sourced from <http://twgljs.org/examples/tiny.html>\n\nimport {\n  createBufferInfoFromArrays,\n  createProgramInfo,\n  drawBufferInfo,\n  resizeCanvasToDisplaySize,\n  setBuffersAndAttributes,\n  setUniforms,\n} from 'twgl.js';\nimport { css } from '@linaria/core';\n\nexport const Canvas: React.FC = () => {\n  const onCanvasLoaded = (element: HTMLCanvasElement) => {\n    if (!element) return;\n\n    const gl = element.getContext('webgl');\n\n    if (gl == null) return;\n\n    const programInfo = createProgramInfo(gl, [\n      require('./shaders/vertex.glsl').default,\n      require('./shaders/fragment.glsl').default,\n    ]);\n\n    const arrays = {\n      position: [-1, -1, 0, 1, -1, 0, -1, 1, 0, -1, 1, 0, 1, -1, 0, 1, 1, 0],\n    };\n    const bufferInfo = createBufferInfoFromArrays(gl, arrays);\n\n    function render(time: number) {\n      if (!gl?.canvas) return;\n\n      resizeCanvasToDisplaySize(gl.canvas as HTMLCanvasElement);\n      gl.viewport(0, 0, gl.canvas.width, gl.canvas.height);\n\n      const uniforms = {\n        time: time * 0.001,\n        resolution: [gl.canvas.width, gl.canvas.height],\n      };\n\n      gl.useProgram(programInfo.program);\n      setBuffersAndAttributes(gl, programInfo, bufferInfo);\n      setUniforms(programInfo, uniforms);\n      drawBufferInfo(gl, bufferInfo);\n\n      requestAnimationFrame(render);\n    }\n    requestAnimationFrame(render);\n  };\n  return <canvas className={wrap} ref={onCanvasLoaded} />;\n};\n\nconst wrap = css`\n  width: 100%;\n`;\n\n","href":null}],"language":"plain text"}},{"object":"block","id":"a3ba6c1c-07f0-446e-ba26-72c091372d50","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2022-12-31T16:42:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"WebGL API を叩いたときほど書く量は減ったのではないでしょうか。 three ほどライブラリの容量もないので快適です。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"WebGL API を叩いたときほど書く量は減ったのではないでしょうか。 three ほどライブラリの容量もないので快適です。","href":null}],"color":"default"}},{"object":"block","id":"4b856bb8-1f98-4476-ab15-cbbbed0fb329","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2023-01-02T13:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"three の軽量化について","link":null},"annotations":{"bold":true,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"three の軽量化について","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"7ffde1ce-4233-45fe-b7ed-65fba7938714","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2022-12-31T16:42:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"試してはいないんですが調べるだけ調べました。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"試してはいないんですが調べるだけ調べました。","href":null}],"color":"default"}},{"object":"block","id":"cf8532e4-e2e3-4e8a-9ef0-775c6c7dbf44","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2022-12-31T16:42:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"Three.js の issue の discussion","link":{"url":"https://github.com/mrdoob/three.js/issues/16059"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Three.js の issue の discussion","href":"https://github.com/mrdoob/three.js/issues/16059"},{"type":"text","text":{"content":" とか、 ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" とか、 ","href":null},{"type":"text","text":{"content":"この記事","link":{"url":"https://note.com/unshift/n/n933f0f4a2cbe"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"この記事","href":"https://note.com/unshift/n/n933f0f4a2cbe"},{"type":"text","text":{"content":" (日本語です) を見てもらうとわかるんですが、","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" (日本語です) を見てもらうとわかるんですが、","href":null},{"type":"text","text":{"content":"import { Foo } from 'three'","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"import { Foo } from 'three'","href":null},{"type":"text","text":{"content":" をしても three.js 全体を読み込んでしまうので、デフォルトで tree shaking は機能しません。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" をしても three.js 全体を読み込んでしまうので、デフォルトで tree shaking は機能しません。","href":null}],"color":"default"}},{"object":"block","id":"729ba217-cd65-4453-a6ae-9ad770645249","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2022-12-31T16:42:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"こういった状況を打開するため、 webpack / rollup 向けの ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"こういった状況を打開するため、 webpack / rollup 向けの ","href":null},{"type":"text","text":{"content":"three-minifier","link":{"url":"https://github.com/yushijinhun/three-minifier"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"three-minifier","href":"https://github.com/yushijinhun/three-minifier"},{"type":"text","text":{"content":" という plugin があるようなので、どうしても three で tree shaking をしたいなら試してみるといいかもしれません(","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" という plugin があるようなので、どうしても three で tree shaking をしたいなら試してみるといいかもしれません(","href":null},{"type":"text","text":{"content":"THREE.WebGLRenderer","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"THREE.WebGLRenderer","href":null},{"type":"text","text":{"content":" 単体のサイズが大きいので、 tree shaking した恩恵をあまり受けられないような気もしています)。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" 単体のサイズが大きいので、 tree shaking した恩恵をあまり受けられないような気もしています)。","href":null}],"color":"default"}},{"object":"block","id":"a595d8f6-306c-4c39-b2a5-261a97247796","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2022-12-31T16:42:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"他に three を使わなくなった理由など","link":null},"annotations":{"bold":true,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"他に three を使わなくなった理由など","href":null}],"color":"default"}},{"object":"block","id":"77264a28-9cf1-45ca-8c78-4beb3dbd43b8","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2022-12-31T16:42:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"three 本体の動きとして、","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"three 本体の動きとして、","href":null},{"type":"text","text":{"content":"型定義を削除したPRがマージされた","link":{"url":"https://github.com/mrdoob/three.js/pull/21174"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"型定義を削除したPRがマージされた","href":"https://github.com/mrdoob/three.js/pull/21174"},{"type":"text","text":{"content":" ことがあり、若干の不信感が募っていました。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" ことがあり、若干の不信感が募っていました。","href":null}],"color":"default"}},{"object":"block","id":"f9e6856c-f57f-491f-919a-e19e032c5c55","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2022-12-31T16:42:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"quote","quote":{"rich_text":[{"type":"text","text":{"content":"The side effect of that decision was a considerable increase on maintenance burden and made things harder for new contributors too. For the sake of continuity of the project I think it's best to move them back to DefinitelyTyped (or any other repo interested in maintaining them).","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"The side effect of that decision was a considerable increase on maintenance burden and made things harder for new contributors too. For the sake of continuity of the project I think it's best to move them back to DefinitelyTyped (or any other repo interested in maintaining them).","href":null}],"color":"default"}},{"object":"block","id":"eeabdd80-6aef-447f-a1a3-ca935e84eaf5","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2022-12-31T16:42:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"Mr.doob","link":{"url":"https://twitter.com/mrdoob"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Mr.doob","href":"https://twitter.com/mrdoob"},{"type":"text","text":{"content":" 氏曰く、とにかくメンテが辛かったので負荷を減らしたかったらしいですね。お疲れさまでした。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" 氏曰く、とにかくメンテが辛かったので負荷を減らしたかったらしいですね。お疲れさまでした。","href":null}],"color":"default"}},{"object":"block","id":"77a620eb-6c21-4c80-99e8-f6d406b2d1a7","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2022-12-31T16:42:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"three の型はもういいとして、平面に GLSL を描画する以外のことがしたくなったらまた戻ってくるかもしれないですが、しばらくは TWGL 使うつもりです。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"three の型はもういいとして、平面に GLSL を描画する以外のことがしたくなったらまた戻ってくるかもしれないですが、しばらくは TWGL 使うつもりです。","href":null}],"color":"default"}},{"object":"block","id":"561f1cfb-d16e-4c14-9629-a5748fc232c8","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2023-01-02T13:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"CSS","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"CSS","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"7a42c74d-e517-4aac-b2df-7d14ee0d29c4","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2022-12-31T16:42:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"CSS が JS のランタイムに組み込まれるのは嫌なんですが、 CSSinJS はやりたかったので linaria を使いました（CSSはファイルとして読み込んでほしい）。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"CSS が JS のランタイムに組み込まれるのは嫌なんですが、 CSSinJS はやりたかったので linaria を使いました（CSSはファイルとして読み込んでほしい）。","href":null}],"color":"default"}},{"object":"block","id":"c07134ee-eb81-44be-b49e-384f8b9714fa","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2023-01-02T13:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"heading_1","heading_1":{"rich_text":[{"type":"text","text":{"content":"おわりに","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"おわりに","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"40a24589-6f43-4348-bf2a-0740af02fa29","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2022-12-31T16:42:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"Next.js に頼らないかつ最小の構成で React + WebGL を組みました。その他の疑問点や展望については以下のとおりです。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Next.js に頼らないかつ最小の構成で React + WebGL を組みました。その他の疑問点や展望については以下のとおりです。","href":null}],"color":"default"}},{"object":"block","id":"b93582b9-d8d2-4e3c-a803-466f306c3a1a","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2022-12-31T16:42:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"画像最適化","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"画像最適化","href":null}],"color":"default"}},{"object":"block","id":"37acbb40-ec20-4105-832e-19e5a80132cd","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2022-12-31T16:42:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":true,"archived":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"適切なチャンク分割","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"適切なチャンク分割","href":null}],"color":"default"}},{"object":"block","id":"4388b4da-ce97-4af6-b9c7-77a23cc6fd31","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2022-12-31T16:42:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":true,"archived":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"GLSL ファイルを読み込むための raw-loader","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"GLSL ファイルを読み込むための raw-loader","href":null}],"color":"default"}},{"object":"block","id":"178d4882-5c57-4575-9a8e-91f97c4c51f4","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2022-12-31T16:42:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"動的な routing 対応","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"動的な routing 対応","href":null}],"color":"default"}},{"object":"block","id":"070b9068-99a6-47ec-ad47-b3e5d24e3748","parent":{"type":"page_id","page_id":"642869d7-925f-4e1e-9583-54f12f71d1a5"},"created_time":"2022-12-31T16:42:00.000Z","last_edited_time":"2022-12-31T16:42:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"まだ劣化 Next.js に WebGL の環境のせましたという感じなのでここらへんやっていきます。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"まだ劣化 Next.js に WebGL の環境のせましたという感じなのでここらへんやっていきます。","href":null}],"color":"default"}}]}},"prevEntry":{"head":{"slug":"share-types-of-formdata-php-ts","tags":["engineering"],"created":"2022-12-31T16:37:00.000Z","updated":"2023-01-04T06:34:00.000Z","title":"TSとPHPでFormDataの型を共有する","coverImageUrl":null},"body":{"content":[{"object":"block","id":"33e25069-2e24-4c66-b361-950f8cba51f0","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"table_of_contents","table_of_contents":{"color":"gray"}},{"object":"block","id":"c508ccb0-ceef-4e09-b44e-c01c6c19e369","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2023-01-02T13:50:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"heading_1","heading_1":{"rich_text":[{"type":"text","text":{"content":"背景","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"背景","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"a044d7b6-ebdd-49c6-9357-18312f0017ad","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"<blockquote class=\"twitter-tweet\"><p lang=\"ja\" dir=\"ltr\">TSとPHP間のFormDataの型めっちゃつらいやつ毎回なってる</p>— Shuta (@did0es) <a href=\"","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"<blockquote class=\"twitter-tweet\"><p lang=\"ja\" dir=\"ltr\">TSとPHP間のFormDataの型めっちゃつらいやつ毎回なってる</p>— Shuta (@did0es) <a href=\"","href":null},{"type":"text","text":{"content":"https://twitter.com/did0es/status/1401471990259613697?ref_src=twsrc^tfw","link":{"url":"https://twitter.com/did0es/status/1401471990259613697?ref_src=twsrc%5Etfw"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"https://twitter.com/did0es/status/1401471990259613697?ref_src=twsrc^tfw","href":"https://twitter.com/did0es/status/1401471990259613697?ref_src=twsrc%5Etfw"},{"type":"text","text":{"content":"\">June 6, 2021</a></blockquote>","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"\">June 6, 2021</a></blockquote>","href":null}],"color":"default"}},{"object":"block","id":"7e12e270-68b7-47fe-abd7-a4b2d949e09d","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"サーバーサイドで Node.js が動かない環境(某レンタルサーバー)でアプリケーションを実装する必要が生じたため、","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"サーバーサイドで Node.js が動かない環境(某レンタルサーバー)でアプリケーションを実装する必要が生じたため、","href":null},{"type":"text","text":{"content":"渋々","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":true,"underline":false,"code":false,"color":"default"},"plain_text":"渋々","href":null},{"type":"text","text":{"content":" PHP を書いていたんですが、クライアントサイドは React で書きたいという我儘が出てきてしまい、その欲望に従った結果型を共有出来ないゆえの地獄を見たのでその脱出を図りました。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" PHP を書いていたんですが、クライアントサイドは React で書きたいという我儘が出てきてしまい、その欲望に従った結果型を共有出来ないゆえの地獄を見たのでその脱出を図りました。","href":null}],"color":"default"}},{"object":"block","id":"8f39de94-2b4b-4b7b-b7a1-f5753ed25c06","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2023-01-02T13:51:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"heading_1","heading_1":{"rich_text":[{"type":"text","text":{"content":"概観","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"概観","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"1228efba-6706-42a9-9938-aada38193f13","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"筆者は ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"筆者は ","href":null},{"type":"text","text":{"content":"FormData","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"FormData","href":null},{"type":"text","text":{"content":" を扱う際に以下のような型の拡張を書いた","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" を扱う際に以下のような型の拡張を書いた","href":null},{"type":"text","text":{"content":"d.ts","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"d.ts","href":null},{"type":"text","text":{"content":"ファイルを使うことがあります。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"ファイルを使うことがあります。","href":null}],"color":"default"}},{"object":"block","id":"5c33b792-d87d-4e2e-a6c0-a242613c1b89","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"interface FormData {\n  append(\n    name: 'foo' | 'piyo' | 'fuga',\n    value: string | Blob,\n    filename?: string\n  ): void;\n}\n","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"interface FormData {\n  append(\n    name: 'foo' | 'piyo' | 'fuga',\n    value: string | Blob,\n    filename?: string\n  ): void;\n}\n","href":null}],"language":"plain text"}},{"object":"block","id":"8b83d4e9-9611-4770-aefa-5b664d73f03f","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"append","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"append","href":null},{"type":"text","text":{"content":" の ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" の ","href":null},{"type":"text","text":{"content":"name","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"name","href":null},{"type":"text","text":{"content":" を文字列リテラルで縛っています。サーバーサイドも TypeScript の場合この型定義を共有することで、クライアントサイドから送信される ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" を文字列リテラルで縛っています。サーバーサイドも TypeScript の場合この型定義を共有することで、クライアントサイドから送信される ","href":null},{"type":"text","text":{"content":"FormData","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"FormData","href":null},{"type":"text","text":{"content":" の ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" の ","href":null},{"type":"text","text":{"content":"name","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"name","href":null},{"type":"text","text":{"content":" がどのようなものか簡単にわかるようになっています。また VSCode などでは補完機能により、タイポを防いで無駄な確認の手間を省くという意味合いもあります。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" がどのようなものか簡単にわかるようになっています。また VSCode などでは補完機能により、タイポを防いで無駄な確認の手間を省くという意味合いもあります。","href":null}],"color":"default"}},{"object":"block","id":"747b8fd7-0f3e-48a8-83ba-1de08697e41f","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"ただサーバーサイドが PHP の場合(TypeScript 以外の言語でもそうですが)、","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"ただサーバーサイドが PHP の場合(TypeScript 以外の言語でもそうですが)、","href":null},{"type":"text","text":{"content":"d.ts","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"d.ts","href":null},{"type":"text","text":{"content":" ファイルを共有出来ないため、何かしら別の手段を用意する必要があります。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" ファイルを共有出来ないため、何かしら別の手段を用意する必要があります。","href":null}],"color":"default"}},{"object":"block","id":"d487522a-16f4-40da-ade1-6708b9eff8df","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"今回は PHP なので、PHPDoc Types と PHPStan の静的解析による型チェックを活用していきます。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"今回は PHP なので、PHPDoc Types と PHPStan の静的解析による型チェックを活用していきます。","href":null}],"color":"default"}},{"object":"block","id":"c6342d30-f8b9-4ac5-bf5b-e452fceb60c0","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2023-01-02T13:51:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"heading_1","heading_1":{"rich_text":[{"type":"text","text":{"content":"用意するもの","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"用意するもの","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"ef768280-b9cd-4e73-b63e-ba189704f7f8","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"クライアントサイドは TypeScript で書かれている前提で、他にサーバーサイドでは以下のものを用意します。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"クライアントサイドは TypeScript で書かれている前提で、他にサーバーサイドでは以下のものを用意します。","href":null}],"color":"default"}},{"object":"block","id":"91207c7b-120f-445c-b74b-35a071fa784f","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"PHPStan","link":{"url":"https://github.com/phpstan/phpstan"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"PHPStan","href":"https://github.com/phpstan/phpstan"}],"color":"default"}},{"object":"block","id":"2ccc3986-858f-4228-8515-c38ec4ea793d","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"PHP-Parser","link":{"url":"https://github.com/nikic/PHP-Parser"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"PHP-Parser","href":"https://github.com/nikic/PHP-Parser"}],"color":"default"}},{"object":"block","id":"83c2b168-6914-4481-957b-319bccb23040","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"どちらも ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"どちらも ","href":null},{"type":"text","text":{"content":"composer","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"composer","href":null},{"type":"text","text":{"content":" でインストール出来ます。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" でインストール出来ます。","href":null}],"color":"default"}},{"object":"block","id":"11a28c47-18a7-498a-9561-2aa2adea24c2","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2023-01-02T13:51:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"heading_1","heading_1":{"rich_text":[{"type":"text","text":{"content":"実装","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"実装","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"c807b322-c67b-4c0f-a05b-c6a9c7dc19e4","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2023-01-02T13:51:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"FormDataを拡張した型を取り出してJSONにする","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"FormDataを拡張した型を取り出してJSONにする","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"89314788-491a-49d4-b136-2ced7fc7b45c","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"FormData","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"FormData","href":null},{"type":"text","text":{"content":" を拡張した型定義は以下のようになっています。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" を拡張した型定義は以下のようになっています。","href":null}],"color":"default"}},{"object":"block","id":"1419994c-fb70-4330-88b8-a354dfe982a7","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"formdata.d.ts","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"formdata.d.ts","href":null}],"color":"default"}},{"object":"block","id":"e15f9aaf-9fc1-41d1-8864-d67bb9e9beef","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"\ninterface FormData {\n  append(\n    name: 'audio_data' | 'user_dir_name' | 'data_map' | 'result_data',\n    value: string | Blob,\n    filename?: 'data_map' | 'listen_result'\n  ): void;\n}\n\n","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"\ninterface FormData {\n  append(\n    name: 'audio_data' | 'user_dir_name' | 'data_map' | 'result_data',\n    value: string | Blob,\n    filename?: 'data_map' | 'listen_result'\n  ): void;\n}\n\n","href":null}],"language":"plain text"}},{"object":"block","id":"42dbfdc9-89f7-4316-be08-af4ded5783ab","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"上のコードから ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"上のコードから ","href":null},{"type":"text","text":{"content":"name","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"name","href":null},{"type":"text","text":{"content":" の Parameters を取り出して JSON にします。数行程度で実装出来ます。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" の Parameters を取り出して JSON にします。数行程度で実装出来ます。","href":null}],"color":"default"}},{"object":"block","id":"6d89a461-bc28-4867-846e-f6d0de541dfd","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"types-bridge/src/core.ts","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"types-bridge/src/core.ts","href":null}],"color":"default"}},{"object":"block","id":"22926091-6b43-4f30-8de8-c2b20ce1190c","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"import * as path from 'path';\nimport * as ts from 'typescript';\nimport { readFile, writeFile } from 'fs/promises';\n\ntype Properties = { [key: string]: string };\n\nlet properties: Properties = {};\nconst visit = (node: ts.Node | ts.Node[], sourceFile: ts.SourceFile) => {\n  if (Array.isArray(node)) {\n    node.forEach((n) => {\n      visit(n, sourceFile);\n    });\n  } else {\n    if (node.kind === ts.SyntaxKind.Parameter) {\n      const texts = node.getText(sourceFile).split(': ');\n      const key = texts[0];\n      const value = texts[1];\n      properties[key] = value;\n      return;\n    } else {\n      visit(node.getChildren(sourceFile), sourceFile);\n    }\n  }\n};\n\nconst extract = async (file: string) => {\n  const data = await readFile(path.resolve(`../client/src/${file}`));\n  const sourceFile = ts.createSourceFile(\n    file,\n    data.toString(),\n    ts.ScriptTarget.ES2015\n  );\n  visit(sourceFile.getChildren(sourceFile), sourceFile);\n\n  await writeFile(\n    process.cwd() + '/json/formdata.json',\n    JSON.stringify(properties, null, '  ')\n  );\n\n  properties = {};\n};\n\nextract(process.argv[2]);\n","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"import * as path from 'path';\nimport * as ts from 'typescript';\nimport { readFile, writeFile } from 'fs/promises';\n\ntype Properties = { [key: string]: string };\n\nlet properties: Properties = {};\nconst visit = (node: ts.Node | ts.Node[], sourceFile: ts.SourceFile) => {\n  if (Array.isArray(node)) {\n    node.forEach((n) => {\n      visit(n, sourceFile);\n    });\n  } else {\n    if (node.kind === ts.SyntaxKind.Parameter) {\n      const texts = node.getText(sourceFile).split(': ');\n      const key = texts[0];\n      const value = texts[1];\n      properties[key] = value;\n      return;\n    } else {\n      visit(node.getChildren(sourceFile), sourceFile);\n    }\n  }\n};\n\nconst extract = async (file: string) => {\n  const data = await readFile(path.resolve(`../client/src/${file}`));\n  const sourceFile = ts.createSourceFile(\n    file,\n    data.toString(),\n    ts.ScriptTarget.ES2015\n  );\n  visit(sourceFile.getChildren(sourceFile), sourceFile);\n\n  await writeFile(\n    process.cwd() + '/json/formdata.json',\n    JSON.stringify(properties, null, '  ')\n  );\n\n  properties = {};\n};\n\nextract(process.argv[2]);\n","href":null}],"language":"plain text"}},{"object":"block","id":"cabc4f17-a4df-4ab8-9ec3-6c7fc8240f9d","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"visit","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"visit","href":null},{"type":"text","text":{"content":"関数によって型定義の TypeScript AST を Traverse し、該当する ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"関数によって型定義の TypeScript AST を Traverse し、該当する ","href":null},{"type":"text","text":{"content":"SyntaxKind","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"SyntaxKind","href":null},{"type":"text","text":{"content":" を取り出してオブジェクトに格納しています。オブジェクトは後に PHP側 の実装と共有するため JSON として書き出しています。別に JSON じゃなくても PHP 側でも読み込めるファイルであればここは何でもいいです。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" を取り出してオブジェクトに格納しています。オブジェクトは後に PHP側 の実装と共有するため JSON として書き出しています。別に JSON じゃなくても PHP 側でも読み込めるファイルであればここは何でもいいです。","href":null}],"color":"default"}},{"object":"block","id":"c2aa537a-e6a2-4806-9909-37612403f7fe","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2023-01-02T13:51:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"PHP側でJSONのデータをPHPDoc Typesに変換","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"PHP側でJSONのデータをPHPDoc Typesに変換","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"655e3086-3ee0-41e1-a342-efd8e0ef917e","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"POST された ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"POST された ","href":null},{"type":"text","text":{"content":"FormData","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"FormData","href":null},{"type":"text","text":{"content":" は PHP 側で ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" は PHP 側で ","href":null},{"type":"text","text":{"content":"$_FILES","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"$_FILES","href":null},{"type":"text","text":{"content":" から受け取ります。定義済み変数の型を拡張する方法がわからなかったので以下のようなクラスを定義しました。(こうすれば拡張できていいよ！とかあれば教えて下さい)","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" から受け取ります。定義済み変数の型を拡張する方法がわからなかったので以下のようなクラスを定義しました。(こうすれば拡張できていいよ！とかあれば教えて下さい)","href":null}],"color":"default"}},{"object":"block","id":"e8ce2584-3cfd-4f04-b7f9-9d8d0905b83c","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"server/src/shared/http_variables.php","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"server/src/shared/http_variables.php","href":null}],"color":"default"}},{"object":"block","id":"2873616e-8e31-4318-915f-5c58273915a6","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"\n<?php\n\ndeclare (strict_types=1);\nerror_reporting(E_ALL);\n\nclass HttpVariables\n{\n    // ~~\n\n    public function files($key)\n    {\n        return $_FILES[$key];\n    }\n}\n\n","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"\n<?php\n\ndeclare (strict_types=1);\nerror_reporting(E_ALL);\n\nclass HttpVariables\n{\n    // ~~\n\n    public function files($key)\n    {\n        return $_FILES[$key];\n    }\n}\n\n","href":null}],"language":"plain text"}},{"object":"block","id":"8127a30e-cc73-437c-822f-f7e8910686c7","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"この状態で PHPStan を実行すると落ちます。(PHPStan の level は 　max で実行しています)","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"この状態で PHPStan を実行すると落ちます。(PHPStan の level は 　max で実行しています)","href":null}],"color":"default"}},{"object":"block","id":"e98a3ce9-4ab9-480d-88a0-efac82b38abe","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"> ./vendor/bin/phpstan analyze -c phpstan.neon\n 9/9 [▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓] 100%\n\n ------ ------------------------------------------------------------------------------\n  Line   shared/http_variables.php\n ------ ------------------------------------------------------------------------------\n # ~~\n\n  18     Method HttpVariables::files() has no return typehint specified.\n  18     Method HttpVariables::files() has parameter $key with no typehint specified.\n ------ ------------------------------------------------------------------------------\n\n [ERROR] Found 6 errors\n\nScript ./vendor/bin/phpstan analyze -c phpstan.neon handling the phpstan event returned with error code 1\n","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"> ./vendor/bin/phpstan analyze -c phpstan.neon\n 9/9 [▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓] 100%\n\n ------ ------------------------------------------------------------------------------\n  Line   shared/http_variables.php\n ------ ------------------------------------------------------------------------------\n # ~~\n\n  18     Method HttpVariables::files() has no return typehint specified.\n  18     Method HttpVariables::files() has parameter $key with no typehint specified.\n ------ ------------------------------------------------------------------------------\n\n [ERROR] Found 6 errors\n\nScript ./vendor/bin/phpstan analyze -c phpstan.neon handling the phpstan event returned with error code 1\n","href":null}],"language":"plain text"}},{"object":"block","id":"fbbe5230-7d36-472a-8ac2-e4b56cad9e83","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"この PHPStan による型チェックが通ることをゴールに進めます。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"この PHPStan による型チェックが通ることをゴールに進めます。","href":null}],"color":"default"}},{"object":"block","id":"ea146692-a841-4065-8072-066d9af41ee1","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"files","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"files","href":null},{"type":"text","text":{"content":" メソッドの ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" メソッドの ","href":null},{"type":"text","text":{"content":"@return","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"@return","href":null},{"type":"text","text":{"content":" の型はとりあえず以下のように設定しておきます。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" の型はとりあえず以下のように設定しておきます。","href":null}],"color":"default"}},{"object":"block","id":"d6c3a83a-ac8c-4a7a-b47f-4ac8b88a918a","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"/**\n * @phpstan-type Files array{tmp_name: string, name: string}\n */\nclass HttpVariables\n{\n    // ~~\n\n    /**\n     * @return Files\n     */\n    public function files($key)\n    {\n        return $_FILES[$key];\n    }\n}\n","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"/**\n * @phpstan-type Files array{tmp_name: string, name: string}\n */\nclass HttpVariables\n{\n    // ~~\n\n    /**\n     * @return Files\n     */\n    public function files($key)\n    {\n        return $_FILES[$key];\n    }\n}\n","href":null}],"language":"plain text"}},{"object":"block","id":"ccc423f2-915a-4e32-9773-682d75253e1e","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"@param","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"@param","href":null},{"type":"text","text":{"content":" の方は先程用意した JSON を元に作成します。以下が実際に実装したコードです。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" の方は先程用意した JSON を元に作成します。以下が実際に実装したコードです。","href":null}],"color":"default"}},{"object":"block","id":"76412c4d-d60f-442c-ba3b-0d3d24506b01","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"server/scripts/types-bridge-client.php","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"server/scripts/types-bridge-client.php","href":null}],"color":"default"}},{"object":"block","id":"2ca97f20-dfa9-4d24-9aec-a9a3e61c3782","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"<?php\n  declare(strict_types=1);\n\n  error_reporting(E_ALL);\n\n  require(dirname(__FILE__) . \"/../vendor/autoload.php\");\n\n  use PhpParser\\\\Comment\\\\Doc;\n  use PhpParser\\\\Error;\n  use PhpParser\\\\ParserFactory;\n  use PhpParser\\\\Node;\n  use PhpParser\\\\Node\\\\Stmt\\\\ClassMethod;\n  use PhpParser\\\\NodeTraverser;\n  use PhpParser\\\\NodeVisitorAbstract;\n  use PhpParser\\\\PrettyPrinter;\n\n  $target_php_file = 'http_variables.php';\n  $target_types_file = 'formdata.json';\n\n  $target_php_file_path = __DIR__ . \"/../src/shared/\" . $target_php_file;\n  $target_types_file_path = __DIR__ . \"/../../types-bridge/json/\" . $target_types_file;\n\n  $php_code = file_get_contents($target_php_file_path);\n  $formdata_types_json = json_decode(file_get_contents($target_types_file_path));\n\n  $parser = (new ParserFactory)->create(ParserFactory::PREFER_PHP7);\n  try {\n      $ast = $parser->parse($php_code);\n  } catch (Error $error) {\n      echo \"Parse error: {$error->getMessage()}\\\\n\";\n      return;\n  }\n\n  $traverser = new NodeTraverser();\n\n  class NodeVisitor extends NodeVisitorAbstract\n  {\n      private $formdata_types_json;\n\n      function __construct($formdata_types_json)\n      {\n          $this->formdata_types_json = $formdata_types_json;\n      }\n\n      public function enterNode(Node $node)\n      {\n          if ($node instanceof ClassMethod && $node->name->name === 'files') {\n              $prev_doc_comment = $node->getDocComment()->getText();\n              $prev_doc_comment_lines = preg_split('/\\\\n/', $prev_doc_comment);\n              $formatted_comment_lines = array_map(function ($line) {\n                  return trim(preg_replace('/\\\\*/', \"\", $line));\n              }, $prev_doc_comment_lines);\n              foreach ($formatted_comment_lines as $line) {\n                  if (preg_match('/@param/', $line)) {\n                      $words = preg_split('/\\\\s/', $line);\n                      $param_name = $words[array_key_last($words)];\n                      $param_types = $this->formdata_types_json->name;\n                      $new_doc_comments = \"/**\n                       * @param $param_types $param_name\n                       * @return Files\n                       */\";\n                      $node->setDocComment(new Doc($new_doc_comments));\n                  }\n              }\n          }\n      }\n  }\n\n  $traverser->addVisitor(new NodeVisitor($formdata_types_json));\n\n  $ast = $traverser->traverse($ast);\n\n  if ($ast) {\n      $pretty_printer = new PrettyPrinter\\\\Standard();\n      file_put_contents($target_php_file_path, $pretty_printer->prettyPrintFile($ast));\n  } else {\n      throw new \\\\Exception('Cannot get ast.');\n  }\n\n","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"<?php\n  declare(strict_types=1);\n\n  error_reporting(E_ALL);\n\n  require(dirname(__FILE__) . \"/../vendor/autoload.php\");\n\n  use PhpParser\\\\Comment\\\\Doc;\n  use PhpParser\\\\Error;\n  use PhpParser\\\\ParserFactory;\n  use PhpParser\\\\Node;\n  use PhpParser\\\\Node\\\\Stmt\\\\ClassMethod;\n  use PhpParser\\\\NodeTraverser;\n  use PhpParser\\\\NodeVisitorAbstract;\n  use PhpParser\\\\PrettyPrinter;\n\n  $target_php_file = 'http_variables.php';\n  $target_types_file = 'formdata.json';\n\n  $target_php_file_path = __DIR__ . \"/../src/shared/\" . $target_php_file;\n  $target_types_file_path = __DIR__ . \"/../../types-bridge/json/\" . $target_types_file;\n\n  $php_code = file_get_contents($target_php_file_path);\n  $formdata_types_json = json_decode(file_get_contents($target_types_file_path));\n\n  $parser = (new ParserFactory)->create(ParserFactory::PREFER_PHP7);\n  try {\n      $ast = $parser->parse($php_code);\n  } catch (Error $error) {\n      echo \"Parse error: {$error->getMessage()}\\\\n\";\n      return;\n  }\n\n  $traverser = new NodeTraverser();\n\n  class NodeVisitor extends NodeVisitorAbstract\n  {\n      private $formdata_types_json;\n\n      function __construct($formdata_types_json)\n      {\n          $this->formdata_types_json = $formdata_types_json;\n      }\n\n      public function enterNode(Node $node)\n      {\n          if ($node instanceof ClassMethod && $node->name->name === 'files') {\n              $prev_doc_comment = $node->getDocComment()->getText();\n              $prev_doc_comment_lines = preg_split('/\\\\n/', $prev_doc_comment);\n              $formatted_comment_lines = array_map(function ($line) {\n                  return trim(preg_replace('/\\\\*/', \"\", $line));\n              }, $prev_doc_comment_lines);\n              foreach ($formatted_comment_lines as $line) {\n                  if (preg_match('/@param/', $line)) {\n                      $words = preg_split('/\\\\s/', $line);\n                      $param_name = $words[array_key_last($words)];\n                      $param_types = $this->formdata_types_json->name;\n                      $new_doc_comments = \"/**\n                       * @param $param_types $param_name\n                       * @return Files\n                       */\";\n                      $node->setDocComment(new Doc($new_doc_comments));\n                  }\n              }\n          }\n      }\n  }\n\n  $traverser->addVisitor(new NodeVisitor($formdata_types_json));\n\n  $ast = $traverser->traverse($ast);\n\n  if ($ast) {\n      $pretty_printer = new PrettyPrinter\\\\Standard();\n      file_put_contents($target_php_file_path, $pretty_printer->prettyPrintFile($ast));\n  } else {\n      throw new \\\\Exception('Cannot get ast.');\n  }\n\n","href":null}],"language":"plain text"}},{"object":"block","id":"772caca0-d3e3-4406-84dd-6a73e747c978","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"PHP-Parser","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"PHP-Parser","href":null},{"type":"text","text":{"content":" の ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" の ","href":null},{"type":"text","text":{"content":"PhpParser\\\\NodeTraverser","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"PhpParser\\\\NodeTraverser","href":null},{"type":"text","text":{"content":" を利用して、対象の PHP ファイルから ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" を利用して、対象の PHP ファイルから ","href":null},{"type":"text","text":{"content":"files","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"files","href":null},{"type":"text","text":{"content":" メソッドの PHPDoc Comment を探し出し、","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" メソッドの PHPDoc Comment を探し出し、","href":null},{"type":"text","text":{"content":"getDocComment","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"getDocComment","href":null},{"type":"text","text":{"content":" で取り出しています。取り出したコメントは整形した後、","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" で取り出しています。取り出したコメントは整形した後、","href":null},{"type":"text","text":{"content":"@param","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"@param","href":null},{"type":"text","text":{"content":" の型に相当する部分を読み込んだ JSON を元に ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" の型に相当する部分を読み込んだ JSON を元に ","href":null},{"type":"text","text":{"content":"setDocComment","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"setDocComment","href":null},{"type":"text","text":{"content":" で置き換えています。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" で置き換えています。","href":null}],"color":"default"}},{"object":"block","id":"2f59b4b8-eeba-4d8e-8905-5ba0488ef2ae","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"試しにこの ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"試しにこの ","href":null},{"type":"text","text":{"content":"files","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"files","href":null},{"type":"text","text":{"content":" メソッドの戻り値から目当ての値を呼び出してみます。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" メソッドの戻り値から目当ての値を呼び出してみます。","href":null}],"color":"default"}},{"object":"block","id":"329579bd-b654-4e0b-93c2-d579e8383a78","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"<?php\n  // ~~\n\n  $http_variables = new HttpVariables();\n\n  (function () use ($mkdir, $http_variables) {\n      $files = $http_variables->files('result_data');\n      $input = $files['tmp_name'];\n      $output = $files['name'] . \".json\";\n\n      if (move_uploaded_file($input, \"./\" . $mkdir->full_data_dir_name . \"/\" . $output)) {\n          echo json_encode(['message' => 'Created listen result data.']);\n      } else {\n          http_response_code(405);\n      }\n  })();\n\n","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"<?php\n  // ~~\n\n  $http_variables = new HttpVariables();\n\n  (function () use ($mkdir, $http_variables) {\n      $files = $http_variables->files('result_data');\n      $input = $files['tmp_name'];\n      $output = $files['name'] . \".json\";\n\n      if (move_uploaded_file($input, \"./\" . $mkdir->full_data_dir_name . \"/\" . $output)) {\n          echo json_encode(['message' => 'Created listen result data.']);\n      } else {\n          http_response_code(405);\n      }\n  })();\n\n","href":null}],"language":"plain text"}},{"object":"block","id":"99ebda46-8a2c-41a5-a9d6-7ba0f9dad06a","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"PHPStan による型チェックは通ります。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"PHPStan による型チェックは通ります。","href":null}],"color":"default"}},{"object":"block","id":"efaf26cd-3d1f-4475-8e12-5a7880877783","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"$ composer --working-dir=workspaces/server phpstan\n> ./vendor/bin/phpstan analyze -c phpstan.neon\n 9/9 [▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓] 100%\n\n [OK] No errors\n\n✨  Done in 0.69s.\n","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"$ composer --working-dir=workspaces/server phpstan\n> ./vendor/bin/phpstan analyze -c phpstan.neon\n 9/9 [▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓] 100%\n\n [OK] No errors\n\n✨  Done in 0.69s.\n","href":null}],"language":"plain text"}},{"object":"block","id":"1f380976-236e-433a-b5c3-849d58703828","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"🎉","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"🎉","href":null}],"color":"default"}},{"object":"block","id":"2766efd2-ed5a-4788-9ce6-ce2449b8a5a2","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"ちなみに呼び出す際の key を先程生成した PHPDoc Types に存在しないものにするとちゃんとチェックは落ちます。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"ちなみに呼び出す際の key を先程生成した PHPDoc Types に存在しないものにするとちゃんとチェックは落ちます。","href":null}],"color":"default"}},{"object":"block","id":"f87c85e9-dd38-49f4-bdb2-2eaa978c962b","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"<?php\n  // ~~\n\n  $http_variables = new HttpVariables();\n\n  $mkdir = new Mkdir($http_variables);\n  $mkdir->set();\n\n  (function () use ($mkdir, $http_variables) {\n      $files = $http_variables->files('something');\n      $input = $files['tmp_name'];\n      $output = $files['name'] . \".json\";\n\n      if (move_uploaded_file($input, \"./\" . $mkdir->full_data_dir_name . \"/\" . $output)) {\n          echo json_encode(['message' => 'Created listen result data.']);\n      } else {\n          http_response_code(405);\n      }\n  })();\n\n","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"<?php\n  // ~~\n\n  $http_variables = new HttpVariables();\n\n  $mkdir = new Mkdir($http_variables);\n  $mkdir->set();\n\n  (function () use ($mkdir, $http_variables) {\n      $files = $http_variables->files('something');\n      $input = $files['tmp_name'];\n      $output = $files['name'] . \".json\";\n\n      if (move_uploaded_file($input, \"./\" . $mkdir->full_data_dir_name . \"/\" . $output)) {\n          echo json_encode(['message' => 'Created listen result data.']);\n      } else {\n          http_response_code(405);\n      }\n  })();\n\n","href":null}],"language":"plain text"}},{"object":"block","id":"d9818f95-9a1c-43d2-93ff-2585d00cd8fb","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"$ composer --working-dir=workspaces/server phpstan\n> ./vendor/bin/phpstan analyze -c phpstan.neon\n 9/9 [▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓] 100%\n\n ------ --------------------------------------------------------------------------------------------------------------------------------------\n  Line   listen/set_result_data.php\n ------ --------------------------------------------------------------------------------------------------------------------------------------\n  18     Parameter #1 $key of method HttpVariables::files() expects 'audio_data'|'data_map'|'result_data'|'user_dir_name', 'something' given.\n ------ --------------------------------------------------------------------------------------------------------------------------------------\n\n [ERROR] Found 1 error\n\nScript ./vendor/bin/phpstan analyze -c phpstan.neon handling the phpstan event returned with error code 1\n\n","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"$ composer --working-dir=workspaces/server phpstan\n> ./vendor/bin/phpstan analyze -c phpstan.neon\n 9/9 [▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓] 100%\n\n ------ --------------------------------------------------------------------------------------------------------------------------------------\n  Line   listen/set_result_data.php\n ------ --------------------------------------------------------------------------------------------------------------------------------------\n  18     Parameter #1 $key of method HttpVariables::files() expects 'audio_data'|'data_map'|'result_data'|'user_dir_name', 'something' given.\n ------ --------------------------------------------------------------------------------------------------------------------------------------\n\n [ERROR] Found 1 error\n\nScript ./vendor/bin/phpstan analyze -c phpstan.neon handling the phpstan event returned with error code 1\n\n","href":null}],"language":"plain text"}},{"object":"block","id":"b7c09d12-c1d7-4919-9529-bc614fcfb950","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2023-01-02T13:51:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"heading_1","heading_1":{"rich_text":[{"type":"text","text":{"content":"おわりに","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"おわりに","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"837b5d03-e929-4742-9ca7-8fb620967db1","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"サーバーサイドが TypeScript でない状況でもどうにか　AST の力を借りて型を共有してみました。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"サーバーサイドが TypeScript でない状況でもどうにか　AST の力を借りて型を共有してみました。","href":null}],"color":"default"}},{"object":"block","id":"51aba711-bbff-4347-b71d-03968b321038","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"PHP の ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"PHP の ","href":null},{"type":"text","text":{"content":"$_FILES","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"$_FILES","href":null},{"type":"text","text":{"content":" 以外に ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" 以外に ","href":null},{"type":"text","text":{"content":"$_GET","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"$_GET","href":null},{"type":"text","text":{"content":"や ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"や ","href":null},{"type":"text","text":{"content":"$_POST","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"$_POST","href":null},{"type":"text","text":{"content":" でも同様に拡張した型定義があれば ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" でも同様に拡張した型定義があれば ","href":null},{"type":"text","text":{"content":"FormData","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"FormData","href":null},{"type":"text","text":{"content":" 以外でも PHP 側に型を流すことが出来ると思います。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" 以外でも PHP 側に型を流すことが出来ると思います。","href":null}],"color":"default"}},{"object":"block","id":"c10d593c-140b-4573-9a62-ba60d3d40679","parent":{"type":"page_id","page_id":"0ac62654-ea0a-4d98-8a5f-a646b4a5e964"},"created_time":"2022-12-31T16:37:00.000Z","last_edited_time":"2022-12-31T16:37:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"実際に実装したリポジトリなどは公開していないのでお見せ出来ないんですが、何か質問やまさかりなどあれば ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"実際に実装したリポジトリなどは公開していないのでお見せ出来ないんですが、何か質問やまさかりなどあれば ","href":null},{"type":"text","text":{"content":"shuta","link":{"url":"https://twitter.com/did0es"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"shuta","href":"https://twitter.com/did0es"},{"type":"text","text":{"content":" までお願いします。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" までお願いします。","href":null}],"color":"default"}}]}},"nextEntry":{"head":{"slug":"background-of-graduation-thesis","tags":["engineering"],"created":"2022-12-31T16:47:00.000Z","updated":"2023-01-02T13:52:00.000Z","title":"卒論を支えた技術","coverImageUrl":null},"body":{"content":[{"object":"block","id":"56d27bc5-cf27-428e-8096-84579d434fc3","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"table_of_contents","table_of_contents":{"color":"gray"}},{"object":"block","id":"15e7a00c-1049-4f96-9bb7-01efae97097c","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"divider","divider":{}},{"object":"block","id":"584068b8-7f03-447e-ba19-5f01a05a1473","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"title: 卒論を支えた技術\nslug: background-of-graduation-thesis\ntags: []\nupdated: 2022-02-02T03:53:36.781Z\ncreated: 2022-01-16T17:34:34.716Z","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"title: 卒論を支えた技術\nslug: background-of-graduation-thesis\ntags: []\nupdated: 2022-02-02T03:53:36.781Z\ncreated: 2022-01-16T17:34:34.716Z","href":null}],"color":"default"}},{"object":"block","id":"2d574263-1b52-45bb-a3d3-60c579a8a352","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"divider","divider":{}},{"object":"block","id":"e3aa4d0d-fb92-47b0-a3e2-2335abafc1cf","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"とりあえず学部の卒論が書けたので、ゴール前に寝そべりながらこういう文章を書いてる。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"とりあえず学部の卒論が書けたので、ゴール前に寝そべりながらこういう文章を書いてる。","href":null}],"color":"default"}},{"object":"block","id":"25fb7492-36ac-4f80-9bf9-e90879a504fb","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"ここ半年ぐらい卒論という存在の生活に占める割合が大きすぎて、個人として技術に関して得た知見のアウトプットがあまり出来なかったので卒論で構築したWebアプリをネタにちまちま書く。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"ここ半年ぐらい卒論という存在の生活に占める割合が大きすぎて、個人として技術に関して得た知見のアウトプットがあまり出来なかったので卒論で構築したWebアプリをネタにちまちま書く。","href":null}],"color":"default"}},{"object":"block","id":"1465f6d6-70f3-4335-9b46-63e040ca5553","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2023-01-02T13:52:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"heading_1","heading_1":{"rich_text":[{"type":"text","text":{"content":"さらっと研究紹介","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"さらっと研究紹介","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"0b31be3c-3e93-4da7-9a1c-369e0c1e5a43","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2023-01-01T01:03:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"ある用途に向けた音声のデータセット構築を行っていた。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"ある用途に向けた音声のデータセット構築を行っていた。","href":null}],"color":"default"}},{"object":"block","id":"b061bc01-4dee-4596-ad91-c1b16ad34da0","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"データセットの構築は「構築して終わり」じゃなくて、構築したデータセットの性能や特性の評価とかも行うが、この過程に対してそこまで興味が沸かなかったので今回は書かない。手法調べてGoogle Colabでscikit-learn使ってバババッてしたらモデルの学習完了だったので、特に収穫と思しきものがなかったし楽しくもなかった。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"データセットの構築は「構築して終わり」じゃなくて、構築したデータセットの性能や特性の評価とかも行うが、この過程に対してそこまで興味が沸かなかったので今回は書かない。手法調べてGoogle Colabでscikit-learn使ってバババッてしたらモデルの学習完了だったので、特に収穫と思しきものがなかったし楽しくもなかった。","href":null}],"color":"default"}},{"object":"block","id":"0cd8164a-7fc9-4916-947e-7c9bd618da5a","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"全部完了して「よし卒論書くぞ」と始めたところ、結局データセットの仕様やら評価手法やらを中心に書くことになったので、全然データ収集の話を書けなくて萎えていた。論文だから仕方ないがせっかくなのでブログに吐き出して供養する。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"全部完了して「よし卒論書くぞ」と始めたところ、結局データセットの仕様やら評価手法やらを中心に書くことになったので、全然データ収集の話を書けなくて萎えていた。論文だから仕方ないがせっかくなのでブログに吐き出して供養する。","href":null}],"color":"default"}},{"object":"block","id":"4c981905-83c0-4b9a-b38e-7cb8390d470e","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2023-01-02T13:52:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"heading_1","heading_1":{"rich_text":[{"type":"text","text":{"content":"研究を支えた技術","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"研究を支えた技術","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"f10c4e55-7424-4276-b0b8-07bf20b730fc","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2023-01-02T13:52:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"アプリの背景","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"アプリの背景","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"672b1b6e-aed9-4b14-92b0-ce83f76897d6","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"はじめにアプリの背景について触れる。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"はじめにアプリの背景について触れる。","href":null}],"color":"default"}},{"object":"block","id":"f2d2574c-3bb5-4b91-a18a-5240d0125fe8","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"データの収集にはご時世ということもあって人の声を対面で録音することが憚られたので、録音兼ラベル付け用Webアプリをフルスクラッチで実装(フロントエンド・バックエンドを実装)し、クラウドソーシングで募った被験者にURLを渡して行った。合計で700 ~ 800人ぐらいがこのアプリを使った。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"データの収集にはご時世ということもあって人の声を対面で録音することが憚られたので、録音兼ラベル付け用Webアプリをフルスクラッチで実装(フロントエンド・バックエンドを実装)し、クラウドソーシングで募った被験者にURLを渡して行った。合計で700 ~ 800人ぐらいがこのアプリを使った。","href":null}],"color":"default"}},{"object":"block","id":"5c56229d-8006-47b0-adca-30f7dc132215","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2023-01-01T01:04:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"構想からリリースまでの期間は大体3ヶ月ぐらい。割と期間に余裕があるように思えるが、もちろん研究以外のこともやってたので、実質1ヶ月ぐらいの工数で進めてたと思う。去年の夏頃に卒論テーマが決まってから全てのデータ収集が完了したのが12月ぐらいなので、メンテ・その他対応(教授からの唐突な要求に答えるための対応や、ちょっとした障害の対応など)も含めると期間として半年はアプリのソースコードをいじってた。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"構想からリリースまでの期間は大体3ヶ月ぐらい。割と期間に余裕があるように思えるが、もちろん研究以外のこともやってたので、実質1ヶ月ぐらいの工数で進めてたと思う。去年の夏頃に卒論テーマが決まってから全てのデータ収集が完了したのが12月ぐらいなので、メンテ・その他対応(教授からの唐突な要求に答えるための対応や、ちょっとした障害の対応など)も含めると期間として半年はアプリのソースコードをいじってた。","href":null}],"color":"default"}},{"object":"block","id":"e70a42cc-6ad2-4ed0-bb73-84ee38aa5769","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2023-01-01T01:04:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"ちなみに見せられないよって感じの部分があったり、アプリのURLからクラウドソーシング上のタスクを推測されて変なことされると困るので、見せられるブツは特に無い。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"ちなみに見せられないよって感じの部分があったり、アプリのURLからクラウドソーシング上のタスクを推測されて変なことされると困るので、見せられるブツは特に無い。","href":null}],"color":"default"}},{"object":"block","id":"dbbf8d35-f061-496c-8a66-abfd72cdc5d6","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2023-01-01T01:04:00.000Z","last_edited_time":"2023-01-01T01:04:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"その代わり技術的な取り組みをなるべく細かく書く。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"その代わり技術的な取り組みをなるべく細かく書く。","href":null}],"color":"default"}},{"object":"block","id":"0c9a7d21-3140-4347-8602-1c8cc4032fc8","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2023-01-02T13:52:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"アプリの構成","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"アプリの構成","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"035d228d-9e21-42c0-9e5d-f489ac75109c","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"アプリのフロントエンドにNext.js、バックエンドにPHPを使った。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"アプリのフロントエンドにNext.js、バックエンドにPHPを使った。","href":null}],"color":"default"}},{"object":"block","id":"088efc3a-0d73-4d09-8096-5f2af1f513fc","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2023-01-01T01:05:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"技術選定の根拠を話すと、研究室で借りているさくらのレンタルサーバーでアプリのホスティングを行うことになったのでこうなった。ホスティング先決定前はNode.jsでバックエンドを実装する気満々だったが、このレンサバ上では動かない(参考: ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"技術選定の根拠を話すと、研究室で借りているさくらのレンタルサーバーでアプリのホスティングを行うことになったのでこうなった。ホスティング先決定前はNode.jsでバックエンドを実装する気満々だったが、このレンサバ上では動かない(参考: ","href":null},{"type":"text","text":{"content":"https://rs.sakura.ad.jp/function/cgi/#:~:text=独自にプログラミングしたCGI,言語が使用できます。","link":{"url":"https://rs.sakura.ad.jp/function/cgi/#:~:text=%E7%8B%AC%E8%87%AA%E3%81%AB%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0%E3%81%97%E3%81%9FCGI,%E8%A8%80%E8%AA%9E%E3%81%8C%E4%BD%BF%E7%94%A8%E3%81%A7%E3%81%8D%E3%81%BE%E3%81%99%E3%80%82"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"https://rs.sakura.ad.jp/function/cgi/#:~:text=独自にプログラミングしたCGI,言語が使用できます。","href":"https://rs.sakura.ad.jp/function/cgi/#:~:text=%E7%8B%AC%E8%87%AA%E3%81%AB%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0%E3%81%97%E3%81%9FCGI,%E8%A8%80%E8%AA%9E%E3%81%8C%E4%BD%BF%E7%94%A8%E3%81%A7%E3%81%8D%E3%81%BE%E3%81%99%E3%80%82"},{"type":"text","text":{"content":")ので次に慣れているPHPを使った(ちなみにさくらのレンサバでNode.jsが動いたとしても、daemonを実装すると強制停止させられる可能性があるのでどのみち厳しかった気がする: ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":")ので次に慣れているPHPを使った(ちなみにさくらのレンサバでNode.jsが動いたとしても、daemonを実装すると強制停止させられる可能性があるのでどのみち厳しかった気がする: ","href":null},{"type":"text","text":{"content":"https://help.sakura.ad.jp/206206041/?_ga=2.103246144.1768828013.1642372001-472689077.1617430242","link":{"url":"https://help.sakura.ad.jp/206206041/?_ga=2.103246144.1768828013.1642372001-472689077.1617430242"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"https://help.sakura.ad.jp/206206041/?_ga=2.103246144.1768828013.1642372001-472689077.1617430242","href":"https://help.sakura.ad.jp/206206041/?_ga=2.103246144.1768828013.1642372001-472689077.1617430242"},{"type":"text","text":{"content":")。フロントエンドはNext.jsのSGで書き出した静的ファイルをレンサバの公開ディレクトリに設置するようにした。PHPのコード中にHTMLを絶対に埋め込みたくないというか、あまりPHPを書くモチベがなかったのでNext.jsで解決出来ることは全部これでやった。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":")。フロントエンドはNext.jsのSGで書き出した静的ファイルをレンサバの公開ディレクトリに設置するようにした。PHPのコード中にHTMLを絶対に埋め込みたくないというか、あまりPHPを書くモチベがなかったのでNext.jsで解決出来ることは全部これでやった。","href":null}],"color":"default"}},{"object":"block","id":"82be0654-fc20-4839-a0cb-4b425ddc2634","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"以下リポジトリの構成。monorepo風味のプロジェクトになっている。Yarn Workspaceを使って、","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"以下リポジトリの構成。monorepo風味のプロジェクトになっている。Yarn Workspaceを使って、","href":null},{"type":"text","text":{"content":"scripts","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"scripts","href":null},{"type":"text","text":{"content":"には収まらないような適当なCLIツールも一緒に実装出来るようにした。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"には収まらないような適当なCLIツールも一緒に実装出来るようにした。","href":null}],"color":"default"}},{"object":"block","id":"ffa11254-6087-4a42-9492-234caafeedd2","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":".\n├── README.md\n├── babel.config.js\n├── data/\n├── jest.config.js\n├── package.json\n├── scripts\n│   ├── add-fake-choice.js\n│   ├── check-listen-num.js\n│   ├── deploy-client.js\n│   ├── deploy-server.js\n│   ├── filter-listen-data-120.js\n│   ├── format-user-meta-data.js\n│   ├── generate-dataset.js\n│   ├── generate-text.js\n│   ├── group-recorded-data.js\n│   ├── json2csv.js\n│   ├── modify-text-ruby.js\n│   ├── shared/\n│   ├── transform-record-result.js\n│   └── validate-listen-result.js\n├── setupJest.ts\n├── tsconfig.base.json\n├── workspaces\n│   ├── client/\n│   ├── server/\n│   └── types-bridge/\n└── yarn.lock\n","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":".\n├── README.md\n├── babel.config.js\n├── data/\n├── jest.config.js\n├── package.json\n├── scripts\n│   ├── add-fake-choice.js\n│   ├── check-listen-num.js\n│   ├── deploy-client.js\n│   ├── deploy-server.js\n│   ├── filter-listen-data-120.js\n│   ├── format-user-meta-data.js\n│   ├── generate-dataset.js\n│   ├── generate-text.js\n│   ├── group-recorded-data.js\n│   ├── json2csv.js\n│   ├── modify-text-ruby.js\n│   ├── shared/\n│   ├── transform-record-result.js\n│   └── validate-listen-result.js\n├── setupJest.ts\n├── tsconfig.base.json\n├── workspaces\n│   ├── client/\n│   ├── server/\n│   └── types-bridge/\n└── yarn.lock\n","href":null}],"language":"plain text"}},{"object":"block","id":"b561084c-3b74-43a3-a15b-10ac2a8d41af","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2023-01-01T01:05:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"workspaces/types-bridge","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"workspaces/types-bridge","href":null},{"type":"text","text":{"content":" については ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" については ","href":null},{"type":"text","text":{"content":"この記事","link":{"url":"https://blog.did0es.me/entry/share-types-of-formdata-php-ts"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"この記事","href":"https://blog.did0es.me/entry/share-types-of-formdata-php-ts"},{"type":"text","text":{"content":" で書いたので良ければ見てほしい。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" で書いたので良ければ見てほしい。","href":null}],"color":"default"}},{"object":"block","id":"12d0c425-5cf8-468b-acb4-ab25f4c91baf","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2023-01-01T01:05:00.000Z","last_edited_time":"2023-01-01T01:05:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"scripts","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"scripts","href":null},{"type":"text","text":{"content":" がてんこ盛りになっているが、アプリ用のデータ準備や収集したデータをデータセットに纏め上げる処理を全てここに集約させた。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" がてんこ盛りになっているが、アプリ用のデータ準備や収集したデータをデータセットに纏め上げる処理を全てここに集約させた。","href":null}],"color":"default"}},{"object":"block","id":"80d72447-cca4-4339-b2bd-de26bd2744af","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2023-01-01T01:05:00.000Z","last_edited_time":"2023-01-01T01:05:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"scripts","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"scripts","href":null},{"type":"text","text":{"content":" で特に見てもらいたいのが","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" で特に見てもらいたいのが","href":null},{"type":"text","text":{"content":"generate-text.js","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"generate-text.js","href":null},{"type":"text","text":{"content":"の一部で、以下の処理でJNASの新聞記事文のテキストルビのTeXファイルからASTを取り出し、読み上げ文用に加工している。ASTを触る機会が増えていたのでこういう実装をさらっと出来て良かった(再帰関数の中はあまり綺麗ではないが)。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"の一部で、以下の処理でJNASの新聞記事文のテキストルビのTeXファイルからASTを取り出し、読み上げ文用に加工している。ASTを触る機会が増えていたのでこういう実装をさらっと出来て良かった(再帰関数の中はあまり綺麗ではないが)。","href":null}],"color":"default"}},{"object":"block","id":"4677db98-6501-46c2-867c-fef7a20e0fda","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2023-01-01T01:06:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"const latexAstParser = require('latex-ast-parser');\n\n// ~~~\n\nlet count = 0;\n/**\n * @type {string[]}\n */\nlet buffer = [];\n/**\n * @param {{ type: string, content: any }[]} node\n * @returns {void}\n */\nconst latexNodeVisitor = (node) => {\n  node.forEach((n) => {\n    if (Array.isArray(n.content) && n.type === 'environment') {\n      latexNodeVisitor(n.content);\n    } else {\n      if (new RegExp(/^\\\\d*$/).test(n.content) && n.type === 'string') {\n        if (count > 1) buffer.push(popSidParFour(n.content));\n        count++;\n      }\n      if (\n        n.type === 'group' &&\n        n.content[0].type !== 'comment' &&\n        n.content[0].content !== 'jarticle'\n      ) {\n        buffer.push(n.content[0].content);\n      }\n    }\n  });\n};\n\n/**\n *\n * @param {(arg: { type: string, content: any }[]) => void} visitor\n * @returns\n */\nconst latexNodeTraverser = (visitor) => {\n  return (ast) => {\n    if (ast.type === 'root') {\n      return visitor(ast.content);\n    } else {\n      throw new Error(\"Given AST's type is not root.\");\n    }\n  };\n};\n\n// ~~~\n\n(async () => {\n  // ~~~\n  const textRubyTexData = await getTextRubyData(\n    'LONG',\n    TEXT_DATA_CONFIGS.DEBUG_FILE_NUMBER\n  );\n\n  const traverse = latexNodeTraverser(latexNodeVisitor);\n  traverse(latexAstParser.parse(textRubyTexData));\n  // ~~~\n})();\n","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"const latexAstParser = require('latex-ast-parser');\n\n// ~~~\n\nlet count = 0;\n/**\n * @type {string[]}\n */\nlet buffer = [];\n/**\n * @param {{ type: string, content: any }[]} node\n * @returns {void}\n */\nconst latexNodeVisitor = (node) => {\n  node.forEach((n) => {\n    if (Array.isArray(n.content) && n.type === 'environment') {\n      latexNodeVisitor(n.content);\n    } else {\n      if (new RegExp(/^\\\\d*$/).test(n.content) && n.type === 'string') {\n        if (count > 1) buffer.push(popSidParFour(n.content));\n        count++;\n      }\n      if (\n        n.type === 'group' &&\n        n.content[0].type !== 'comment' &&\n        n.content[0].content !== 'jarticle'\n      ) {\n        buffer.push(n.content[0].content);\n      }\n    }\n  });\n};\n\n/**\n *\n * @param {(arg: { type: string, content: any }[]) => void} visitor\n * @returns\n */\nconst latexNodeTraverser = (visitor) => {\n  return (ast) => {\n    if (ast.type === 'root') {\n      return visitor(ast.content);\n    } else {\n      throw new Error(\"Given AST's type is not root.\");\n    }\n  };\n};\n\n// ~~~\n\n(async () => {\n  // ~~~\n  const textRubyTexData = await getTextRubyData(\n    'LONG',\n    TEXT_DATA_CONFIGS.DEBUG_FILE_NUMBER\n  );\n\n  const traverse = latexNodeTraverser(latexNodeVisitor);\n  traverse(latexAstParser.parse(textRubyTexData));\n  // ~~~\n})();\n","href":null}],"language":"javascript"}},{"object":"block","id":"ca1d91ce-7fbc-4487-8674-172cb81cd9ca","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"レンサバへのデプロイはFTPを使った。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"レンサバへのデプロイはFTPを使った。","href":null},{"type":"text","text":{"content":"ftp-deploy","link":{"url":"https://github.com/simonh1000/ftp-deploy"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"ftp-deploy","href":"https://github.com/simonh1000/ftp-deploy"},{"type":"text","text":{"content":" というNPMパッケージがあるので、これを使って以下のような簡単なデプロイスクリプト(","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" というNPMパッケージがあるので、これを使って以下のような簡単なデプロイスクリプト(","href":null},{"type":"text","text":{"content":"scripts/deploy-client.js","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"scripts/deploy-client.js","href":null},{"type":"text","text":{"content":")を実装して、Actionsのワークフロー上でフロントエンドのビルド後に実行した。ちなみに dotenv を入れているのは、Actionsが無料枠の天井に到達したときローカルからデプロイするためだったが全然そんなことなかった。サーバーサイドも同様に、書いたPHPのコードをディレクトリごとFTPでレンサバに突っ込んでいる。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":")を実装して、Actionsのワークフロー上でフロントエンドのビルド後に実行した。ちなみに dotenv を入れているのは、Actionsが無料枠の天井に到達したときローカルからデプロイするためだったが全然そんなことなかった。サーバーサイドも同様に、書いたPHPのコードをディレクトリごとFTPでレンサバに突っ込んでいる。","href":null}],"color":"default"}},{"object":"block","id":"2aba784a-b06e-4ab4-b76e-8dee3f0041f3","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"const dotenv = require('dotenv');\ndotenv.config();\nconst FTPDeploy = require('ftp-deploy');\nconst ftpDeploy = new FTPDeploy();\nconst path = require('path');\n\nconst config = {\n  user: process.env.FTP_USERNAME,\n  password: process.env.FTP_PASSWORD,\n  host: process.env.FTP_HOST,\n  localRoot: path.resolve(__dirname, '../workspaces/client/out'),\n  remoteRoot: process.env.FTP_REMOTE_ROOT,\n  include: ['*'],\n};\n\nftpDeploy\n  .deploy(config)\n  .then((res) => console.log('finished: ', res))\n  .catch((err) => console.log(err));\n","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"const dotenv = require('dotenv');\ndotenv.config();\nconst FTPDeploy = require('ftp-deploy');\nconst ftpDeploy = new FTPDeploy();\nconst path = require('path');\n\nconst config = {\n  user: process.env.FTP_USERNAME,\n  password: process.env.FTP_PASSWORD,\n  host: process.env.FTP_HOST,\n  localRoot: path.resolve(__dirname, '../workspaces/client/out'),\n  remoteRoot: process.env.FTP_REMOTE_ROOT,\n  include: ['*'],\n};\n\nftpDeploy\n  .deploy(config)\n  .then((res) => console.log('finished: ', res))\n  .catch((err) => console.log(err));\n","href":null}],"language":"plain text"}},{"object":"block","id":"069de124-53c0-432a-8784-c6d36062200d","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"あとは収集したデータをバックエンドで永続化する際、RDBに出し入れするのが面倒だった(レンサバ上で運用するDBのセキュリティ面の知見を持っていなかった)ので基本的にJSONファイル、音声はWAVEファイルにしてレンサバに保存した。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"あとは収集したデータをバックエンドで永続化する際、RDBに出し入れするのが面倒だった(レンサバ上で運用するDBのセキュリティ面の知見を持っていなかった)ので基本的にJSONファイル、音声はWAVEファイルにしてレンサバに保存した。","href":null}],"color":"default"}},{"object":"block","id":"a6cceb6b-3dd7-44f0-acc4-c73d09e62859","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"アプリの機能としては大きく分けて2つで「音声の録音」「音声の評価(ラベル付け)」がある。次はそれぞれについて書く。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"アプリの機能としては大きく分けて2つで「音声の録音」「音声の評価(ラベル付け)」がある。次はそれぞれについて書く。","href":null}],"color":"default"}},{"object":"block","id":"5ac9066d-599f-4d2d-ae72-6b7bfdbcd869","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2023-01-02T13:52:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"音声の録音","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"音声の録音","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"d2381991-1e8c-4dd5-8e63-029735148ecc","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"収集したい音声が以下の形式だった。雑に表現すると\"そこそこ質の良い研究に使うにあたって一般的な形式の音声\"を収集しようとした。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"収集したい音声が以下の形式だった。雑に表現すると\"そこそこ質の良い研究に使うにあたって一般的な形式の音声\"を収集しようとした。","href":null}],"color":"default"}},{"object":"block","id":"03bd0af1-7cae-4ac4-8410-65a718ce16a4","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"サンプリング周波数: 48kHz","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"サンプリング周波数: 48kHz","href":null}],"color":"default"}},{"object":"block","id":"ffbacb34-09b0-49a5-b871-f8c0f1b8ee10","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"チャンネル: モノラル","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"チャンネル: モノラル","href":null}],"color":"default"}},{"object":"block","id":"bdbf3965-4d88-4138-a29d-f818aac3e3e8","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"量子化ビット数: 16bit","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"量子化ビット数: 16bit","href":null}],"color":"default"}},{"object":"block","id":"2d468241-7396-4a9f-b562-2cabc92aa8af","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"ファイル形式: WAVE","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"ファイル形式: WAVE","href":null}],"color":"default"}},{"object":"block","id":"6a8837e0-8f6b-4420-b81e-cb85566f1f51","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"音声の録音には","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"音声の録音には","href":null},{"type":"text","text":{"content":"MediaStreamRecording API","link":{"url":"https://developer.mozilla.org/en-US/docs/Web/API/MediaRecorder_API"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"MediaStreamRecording API","href":"https://developer.mozilla.org/en-US/docs/Web/API/MediaRecorder_API"},{"type":"text","text":{"content":"という、WebRTC関連のWeb APIを利用した。ここで１つ問題になるのが、被験者は各々使いたいブラウザを使用して音声を録音することで、あるある〜って感じだがやはり悩まされた。とりあえずpolyfill入れておくかと ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"という、WebRTC関連のWeb APIを利用した。ここで１つ問題になるのが、被験者は各々使いたいブラウザを使用して音声を録音することで、あるある〜って感じだがやはり悩まされた。とりあえずpolyfill入れておくかと ","href":null},{"type":"text","text":{"content":"https://github.com/ai/audio-recorder-polyfill","link":{"url":"https://github.com/ai/audio-recorder-polyfill"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"https://github.com/ai/audio-recorder-polyfill","href":"https://github.com/ai/audio-recorder-polyfill"},{"type":"text","text":{"content":" を入れたが、後々になって別にIEは注意書きで使わないように言ったので必要なかった気もする。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" を入れたが、後々になって別にIEは注意書きで使わないように言ったので必要なかった気もする。","href":null}],"color":"default"}},{"object":"block","id":"a2050fa5-7cb4-48ab-bb87-53bfbf933427","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"また、Firefoxでは ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"また、Firefoxでは ","href":null},{"type":"text","text":{"content":"NotSupportedError: AudioContext.createMediaStreamSource: Connecting AudioNodes from AudioContexts with different sample-rate is currently not supported.","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"NotSupportedError: AudioContext.createMediaStreamSource: Connecting AudioNodes from AudioContexts with different sample-rate is currently not supported.","href":null},{"type":"text","text":{"content":" の通り、サンプリング周波数が44.1kHzから変えられなかったので、仕方なしにアプリの注意書きにFirefoxを使わないように書いた。Firefoxの使用を禁止したのは今までで初めてだった。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" の通り、サンプリング周波数が44.1kHzから変えられなかったので、仕方なしにアプリの注意書きにFirefoxを使わないように書いた。Firefoxの使用を禁止したのは今までで初めてだった。","href":null}],"color":"default"}},{"object":"block","id":"61010869-f912-4b05-9f41-90124717036b","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"なお、このエラー　を調べると","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"なお、このエラー　を調べると","href":null},{"type":"text","text":{"content":"こういうGitHub issue上でのやり取り","link":{"url":"https://github.com/nextcloud/spreed/issues/3323"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"こういうGitHub issue上でのやり取り","href":"https://github.com/nextcloud/spreed/issues/3323"},{"type":"text","text":{"content":"が出てくる。Firefox側で対応されたらしいが、自分のmacOS Catalina環境や学内のCentOS 7環境ではバグっていたので直ってない気がする。両方ともOSが古いのも原因としてありえそう。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"が出てくる。Firefox側で対応されたらしいが、自分のmacOS Catalina環境や学内のCentOS 7環境ではバグっていたので直ってない気がする。両方ともOSが古いのも原因としてありえそう。","href":null}],"color":"default"}},{"object":"block","id":"ba82abe2-5520-42ec-88aa-ab6fd3fb351b","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"とりあえずこれらのことは置いておいてpolyfillを使いつつ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"とりあえずこれらのことは置いておいてpolyfillを使いつつ","href":null},{"type":"text","text":{"content":"useRecorder","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"useRecorder","href":null},{"type":"text","text":{"content":"フックを実装し、録音を行う実装を含むReactコンポーネント内で利用するようにした。このフックは","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"フックを実装し、録音を行う実装を含むReactコンポーネント内で利用するようにした。このフックは","href":null},{"type":"text","text":{"content":"https://codesandbox.io/s/81zkxw8qnl","link":{"url":"https://codesandbox.io/s/81zkxw8qnl"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"https://codesandbox.io/s/81zkxw8qnl","href":"https://codesandbox.io/s/81zkxw8qnl"},{"type":"text","text":{"content":"を参考にした。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"を参考にした。","href":null}],"color":"default"}},{"object":"block","id":"84c16ee2-5ad2-4b9f-b72c-1e3dc4cbd302","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"/**\n * <https://codesandbox.io/s/81zkxw8qnl>\n * <https://developers.google.com/web/fundamentals/media/recording-audio>\n * NOTE: ↑ No support for wav format.\n */\n\nimport { useEffect, useState } from 'react';\nimport AudioRecorder from 'audio-recorder-polyfill';\nimport type { TextData } from '../components/RecordPage';\n\nconst requestRecorder = async () => {\n  const stream = await navigator.mediaDevices.getUserMedia({ audio: true });\n  const recorder = new AudioRecorder(stream, { sampleRate: 48000 });\n  return recorder;\n};\n\nexport const useRecorder = () => {\n  const [audioData, setAudioData] = useState<\n    {\n      id: number;\n      text: string;\n      ruby: string;\n      url: string;\n      formData: FormData;\n    }[]\n  >([]);\n  const [isRecording, setIsRecording] = useState(false);\n  const [currentId, setCurrentId] = useState(0);\n  const [currentText, setCurrentText] = useState('');\n  const [currentTextRuby, setCurrentTextRuby] = useState('');\n  const [recorder, setRecorder] = useState<typeof AudioRecorder | null>(null);\n\n  const startRecording = async (data: TextData[number]) => {\n    setCurrentId(data.id);\n    setCurrentText(data.sentence);\n    setCurrentTextRuby(data.ruby);\n    setIsRecording(true);\n  };\n\n  const stopRecording = () => {\n    setIsRecording(false);\n  };\n\n  const onSuccess = async (stream: typeof AudioRecorder) => {\n    setRecorder(stream);\n  };\n\n  const onError = (reason: any) => {\n    console.error(reason);\n    alert('エラーが発生しました。ページを再読み込みしてください。');\n    setCurrentId(0);\n    setCurrentText('');\n    setIsRecording(false);\n    setRecorder(null);\n  };\n\n  const handleOnDataAvailable = async (event: BlobEvent) => {\n    /**\n     * NOTE: 以下の WAV データに変換\n     */\n    if (event.data.size > 0) {\n      // プレビュー用の URL 作成\n      const url = URL.createObjectURL(event.data);\n\n      // サーバーへ送信用の FormData 作成\n      const formData = new FormData();\n      formData.append('audio_data', event.data, `${currentId}`);\n\n      setAudioData((prevState) => [\n        ...prevState,\n        {\n          id: currentId,\n          text: currentText,\n          ruby: currentTextRuby,\n          url,\n          formData,\n        },\n      ]);\n\n      setCurrentId(0);\n      setCurrentText('');\n    }\n  };\n\n  const removeAudioData = (id: number) => {\n    setAudioData((prevState) => prevState.filter((state) => state.id !== id));\n  };\n\n  useEffect(() => {\n    if (recorder === null) {\n      /**\n       * 録音ボタンが押された状態であれば初回 getUserMedia でマイクへのアクセスの許可と AudioRecorder のインスタンス作成\n       */\n      if (isRecording) {\n        requestRecorder().then(onSuccess, onError);\n      }\n      return;\n    }\n\n    if (isRecording) {\n      recorder?.start();\n    } else {\n      recorder?.stop();\n    }\n\n    recorder.addEventListener('dataavailable', handleOnDataAvailable);\n\n    return () => {\n      recorder.removeEventListener('dataavailable', handleOnDataAvailable);\n    };\n  }, [recorder, isRecording]);\n\n  return {\n    audioData,\n    isRecording,\n    startRecording,\n    stopRecording,\n    currentText,\n    removeAudioData,\n  };\n};\n\n","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"/**\n * <https://codesandbox.io/s/81zkxw8qnl>\n * <https://developers.google.com/web/fundamentals/media/recording-audio>\n * NOTE: ↑ No support for wav format.\n */\n\nimport { useEffect, useState } from 'react';\nimport AudioRecorder from 'audio-recorder-polyfill';\nimport type { TextData } from '../components/RecordPage';\n\nconst requestRecorder = async () => {\n  const stream = await navigator.mediaDevices.getUserMedia({ audio: true });\n  const recorder = new AudioRecorder(stream, { sampleRate: 48000 });\n  return recorder;\n};\n\nexport const useRecorder = () => {\n  const [audioData, setAudioData] = useState<\n    {\n      id: number;\n      text: string;\n      ruby: string;\n      url: string;\n      formData: FormData;\n    }[]\n  >([]);\n  const [isRecording, setIsRecording] = useState(false);\n  const [currentId, setCurrentId] = useState(0);\n  const [currentText, setCurrentText] = useState('');\n  const [currentTextRuby, setCurrentTextRuby] = useState('');\n  const [recorder, setRecorder] = useState<typeof AudioRecorder | null>(null);\n\n  const startRecording = async (data: TextData[number]) => {\n    setCurrentId(data.id);\n    setCurrentText(data.sentence);\n    setCurrentTextRuby(data.ruby);\n    setIsRecording(true);\n  };\n\n  const stopRecording = () => {\n    setIsRecording(false);\n  };\n\n  const onSuccess = async (stream: typeof AudioRecorder) => {\n    setRecorder(stream);\n  };\n\n  const onError = (reason: any) => {\n    console.error(reason);\n    alert('エラーが発生しました。ページを再読み込みしてください。');\n    setCurrentId(0);\n    setCurrentText('');\n    setIsRecording(false);\n    setRecorder(null);\n  };\n\n  const handleOnDataAvailable = async (event: BlobEvent) => {\n    /**\n     * NOTE: 以下の WAV データに変換\n     */\n    if (event.data.size > 0) {\n      // プレビュー用の URL 作成\n      const url = URL.createObjectURL(event.data);\n\n      // サーバーへ送信用の FormData 作成\n      const formData = new FormData();\n      formData.append('audio_data', event.data, `${currentId}`);\n\n      setAudioData((prevState) => [\n        ...prevState,\n        {\n          id: currentId,\n          text: currentText,\n          ruby: currentTextRuby,\n          url,\n          formData,\n        },\n      ]);\n\n      setCurrentId(0);\n      setCurrentText('');\n    }\n  };\n\n  const removeAudioData = (id: number) => {\n    setAudioData((prevState) => prevState.filter((state) => state.id !== id));\n  };\n\n  useEffect(() => {\n    if (recorder === null) {\n      /**\n       * 録音ボタンが押された状態であれば初回 getUserMedia でマイクへのアクセスの許可と AudioRecorder のインスタンス作成\n       */\n      if (isRecording) {\n        requestRecorder().then(onSuccess, onError);\n      }\n      return;\n    }\n\n    if (isRecording) {\n      recorder?.start();\n    } else {\n      recorder?.stop();\n    }\n\n    recorder.addEventListener('dataavailable', handleOnDataAvailable);\n\n    return () => {\n      recorder.removeEventListener('dataavailable', handleOnDataAvailable);\n    };\n  }, [recorder, isRecording]);\n\n  return {\n    audioData,\n    isRecording,\n    startRecording,\n    stopRecording,\n    currentText,\n    removeAudioData,\n  };\n};\n\n","href":null}],"language":"plain text"}},{"object":"block","id":"8146670f-82b3-490f-8000-5f23e26858d2","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"ちなみにコードの冒頭にごちゃごちゃ書いているが、","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"ちなみにコードの冒頭にごちゃごちゃ書いているが、","href":null},{"type":"text","text":{"content":"https://developers.google.com/web/fundamentals/media/recording-audio","link":{"url":"https://developers.google.com/web/fundamentals/media/recording-audio"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"https://developers.google.com/web/fundamentals/media/recording-audio","href":"https://developers.google.com/web/fundamentals/media/recording-audio"},{"type":"text","text":{"content":" の例で示されている方法では WAVE ファイルとして音声を録音出来ない(","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" の例で示されている方法では WAVE ファイルとして音声を録音出来ない(","href":null},{"type":"text","text":{"content":".wav","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":".wav","href":null},{"type":"text","text":{"content":"にはなるがffmpegとかで確認すると壊れているし、そもそも再生出来ない、wave surferで表示すら出来ない)。直そう直そうと思って全然やる時間が無いので、コントリビュートチャンスに飢えている誰かいればやってほしい。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"にはなるがffmpegとかで確認すると壊れているし、そもそも再生出来ない、wave surferで表示すら出来ない)。直そう直そうと思って全然やる時間が無いので、コントリビュートチャンスに飢えている誰かいればやってほしい。","href":null}],"color":"default"}},{"object":"block","id":"bef531d6-c609-4c2b-a75d-03fc96dff8a3","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"あとはフックを使っていい感じに録音UIを組めばおわり。Firefoxの件以外はそこまで苦労しなかった。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"あとはフックを使っていい感じに録音UIを組めばおわり。Firefoxの件以外はそこまで苦労しなかった。","href":null}],"color":"default"}},{"object":"block","id":"3054545f-115d-4ef6-98c4-6080a5cab96d","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2023-01-02T13:52:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"音声の評価","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"音声の評価","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"a3621517-db81-435e-8fdb-73d61ce1317c","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"被験者による主観評価によって音声へのラベル付けを行った。評価のUIは各項目1つだけ選択するアンケート形式で実装したかったので、","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"被験者による主観評価によって音声へのラベル付けを行った。評価のUIは各項目1つだけ選択するアンケート形式で実装したかったので、","href":null},{"type":"text","text":{"content":"react-hook-form","link":{"url":"https://react-hook-form.com/"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"react-hook-form","href":"https://react-hook-form.com/"},{"type":"text","text":{"content":"を利用した。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"を利用した。","href":null}],"color":"default"}},{"object":"block","id":"902f0679-0ff0-4157-a19d-622a196b1055","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"実装したReactコンポーネントはこんな感じ。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"実装したReactコンポーネントはこんな感じ。","href":null}],"color":"default"}},{"object":"block","id":"4584aae1-8791-47be-a0ea-93818e6ccee7","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"import { SubmitHandler, useForm, UseFormRegisterReturn } from 'react-hook-form';\nimport { LISTEN_CONTENTS } from '../../configs';\nimport { EuterpeButton } from '../EuterpeButton';\nimport { ColorParette } from '../Instruction';\nimport styles from './EuterpeRadioForm.module.scss';\n\nexport type SelectionsInput = {\n  [K in keyof typeof LISTEN_CONTENTS]: keyof typeof LISTEN_CONTENTS[K]['selections'];\n};\n\ntype CheckboxInputProps = {\n  value: keyof typeof LISTEN_CONTENTS[keyof typeof LISTEN_CONTENTS]['selections'];\n  formRegister: UseFormRegisterReturn;\n};\n\ntype FieldProps = {\n  contents: typeof LISTEN_CONTENTS[keyof typeof LISTEN_CONTENTS];\n  formRegister: UseFormRegisterReturn;\n};\n\ntype Props = {\n  onSubmit: SubmitHandler<SelectionsInput>;\n  inputDisabled: boolean;\n};\n\nconst RadioInput: React.FC<CheckboxInputProps> = ({ value, formRegister }) => {\n  return (\n    <input\n      type=\"radio\"\n      value={value}\n      {...formRegister}\n      className={styles.field_radio}\n    />\n  );\n};\n\nconst Field: React.FC<FieldProps> = ({ contents, formRegister }) => {\n  return (\n    <div className={styles.field_wrapper}>\n      <span className={styles.field_question}>{contents.question}</span>\n      {Object.keys(contents.selections).map((key) => (\n        <label key={key} className={styles.field_container}>\n          <RadioInput\n            value={key as keyof typeof contents['selections']}\n            formRegister={formRegister}\n          />\n          <span>\n            {contents.selections[key as keyof typeof contents['selections']]}\n          </span>\n        </label>\n      ))}\n    </div>\n  );\n};\n\nexport const EuterpeRadioForm: React.FC<Props> = ({\n  onSubmit,\n  inputDisabled,\n}) => {\n  const { register, handleSubmit } = useForm<SelectionsInput>();\n  return (\n    <form onSubmit={handleSubmit(onSubmit)}>\n      <Field\n        contents={LISTEN_CONTENTS.consistency}\n        formRegister={register('consistency', { required: true })}\n      />\n      <Field\n        contents={LISTEN_CONTENTS.recordingConditions}\n        formRegister={register('recordingConditions', { required: true })}\n      />\n      <Field\n        contents={LISTEN_CONTENTS.easeOfListening}\n        formRegister={register('easeOfListening', { required: true })}\n      />\n      <EuterpeButton\n        type=\"submit\"\n        text=\"⏩ 次へ\"\n        bgColor={\n          inputDisabled ? ColorParette.DISABLED : ColorParette.ACCENT_GREEN\n        }\n        disabled={inputDisabled}\n      />\n    </form>\n  );\n};\n\n","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"import { SubmitHandler, useForm, UseFormRegisterReturn } from 'react-hook-form';\nimport { LISTEN_CONTENTS } from '../../configs';\nimport { EuterpeButton } from '../EuterpeButton';\nimport { ColorParette } from '../Instruction';\nimport styles from './EuterpeRadioForm.module.scss';\n\nexport type SelectionsInput = {\n  [K in keyof typeof LISTEN_CONTENTS]: keyof typeof LISTEN_CONTENTS[K]['selections'];\n};\n\ntype CheckboxInputProps = {\n  value: keyof typeof LISTEN_CONTENTS[keyof typeof LISTEN_CONTENTS]['selections'];\n  formRegister: UseFormRegisterReturn;\n};\n\ntype FieldProps = {\n  contents: typeof LISTEN_CONTENTS[keyof typeof LISTEN_CONTENTS];\n  formRegister: UseFormRegisterReturn;\n};\n\ntype Props = {\n  onSubmit: SubmitHandler<SelectionsInput>;\n  inputDisabled: boolean;\n};\n\nconst RadioInput: React.FC<CheckboxInputProps> = ({ value, formRegister }) => {\n  return (\n    <input\n      type=\"radio\"\n      value={value}\n      {...formRegister}\n      className={styles.field_radio}\n    />\n  );\n};\n\nconst Field: React.FC<FieldProps> = ({ contents, formRegister }) => {\n  return (\n    <div className={styles.field_wrapper}>\n      <span className={styles.field_question}>{contents.question}</span>\n      {Object.keys(contents.selections).map((key) => (\n        <label key={key} className={styles.field_container}>\n          <RadioInput\n            value={key as keyof typeof contents['selections']}\n            formRegister={formRegister}\n          />\n          <span>\n            {contents.selections[key as keyof typeof contents['selections']]}\n          </span>\n        </label>\n      ))}\n    </div>\n  );\n};\n\nexport const EuterpeRadioForm: React.FC<Props> = ({\n  onSubmit,\n  inputDisabled,\n}) => {\n  const { register, handleSubmit } = useForm<SelectionsInput>();\n  return (\n    <form onSubmit={handleSubmit(onSubmit)}>\n      <Field\n        contents={LISTEN_CONTENTS.consistency}\n        formRegister={register('consistency', { required: true })}\n      />\n      <Field\n        contents={LISTEN_CONTENTS.recordingConditions}\n        formRegister={register('recordingConditions', { required: true })}\n      />\n      <Field\n        contents={LISTEN_CONTENTS.easeOfListening}\n        formRegister={register('easeOfListening', { required: true })}\n      />\n      <EuterpeButton\n        type=\"submit\"\n        text=\"⏩ 次へ\"\n        bgColor={\n          inputDisabled ? ColorParette.DISABLED : ColorParette.ACCENT_GREEN\n        }\n        disabled={inputDisabled}\n      />\n    </form>\n  );\n};\n\n","href":null}],"language":"plain text"}},{"object":"block","id":"8d297859-226f-480e-99c0-4623b9b91c47","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2023-01-02T13:52:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"バックエンド","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"バックエンド","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"0f7754c1-ff2e-48f9-bb75-f7c53f68f481","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2023-01-01T01:07:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"正直あまり書くことがない。本業ではないという言い訳をしながら、歴戦のPHPerが見ると卒倒しそうなコードを書いた。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"正直あまり書くことがない。本業ではないという言い訳をしながら、歴戦のPHPerが見ると卒倒しそうなコードを書いた。","href":null}],"color":"default"}},{"object":"block","id":"1c8ff1c7-977c-41d7-b658-35655679e307","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2023-01-01T01:07:00.000Z","last_edited_time":"2023-01-01T01:07:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"レンサバ上でcomposer走らせるとかが出来なかったので、とりあえず FormData で送信されてきた音声と評価結果などの各種テキストデータを書き出す処理をそのままのPHPで書いた。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"レンサバ上でcomposer走らせるとかが出来なかったので、とりあえず FormData で送信されてきた音声と評価結果などの各種テキストデータを書き出す処理をそのままのPHPで書いた。","href":null}],"color":"default"}},{"object":"block","id":"d8b21f90-b562-4eb8-9740-0206632eaa2f","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2023-01-01T01:07:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"local では composer を使えるので、","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"local では composer を使えるので、","href":null},{"type":"text","text":{"content":"PHPStan","link":{"url":"https://github.com/phpstan/phpstan"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"PHPStan","href":"https://github.com/phpstan/phpstan"},{"type":"text","text":{"content":"の静的解析で型チェックをしたり、","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"の静的解析で型チェックをしたり、","href":null},{"type":"text","text":{"content":"PHP-CS-Fixer","link":{"url":"https://github.com/FriendsOfPHP/PHP-CS-Fixer"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"PHP-CS-Fixer","href":"https://github.com/FriendsOfPHP/PHP-CS-Fixer"},{"type":"text","text":{"content":"でコードのフォーマットぐらいはやった。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"でコードのフォーマットぐらいはやった。","href":null}],"color":"default"}},{"object":"block","id":"bef22e3b-e362-4f57-94d7-9daf81b04415","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"あと意識したのがセキュリティで、Laravelとかのフレームワークに乗っからなかったので全部調べて自分でどうにかした。Qiitaで","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"あと意識したのがセキュリティで、Laravelとかのフレームワークに乗っからなかったので全部調べて自分でどうにかした。Qiitaで","href":null},{"type":"text","text":{"content":"@tadsan","link":{"url":"https://qiita.com/tadsan"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"@tadsan","href":"https://qiita.com/tadsan"},{"type":"text","text":{"content":"さんや","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"さんや","href":null},{"type":"text","text":{"content":"@rana_kualu","link":{"url":"https://qiita.com/rana_kualu"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"@rana_kualu","href":"https://qiita.com/rana_kualu"},{"type":"text","text":{"content":"さんあたりの記事を見たらマシなPHPが書けた。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"さんあたりの記事を見たらマシなPHPが書けた。","href":null}],"color":"default"}},{"object":"block","id":"2d6d8206-d5b1-4c63-ad40-b30882a5cf99","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"例えばPOSTされた評価ラベルデータを書き出すとかだとこういう感じでPHPを書いた。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"例えばPOSTされた評価ラベルデータを書き出すとかだとこういう感じでPHPを書いた。","href":null}],"color":"default"}},{"object":"block","id":"aa3f6878-28c3-4893-bc4a-facd95e74873","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"<?php\n  declare(strict_types=1);\n\n  error_reporting(E_ALL);\n\n  include dirname(__FILE__) . \"/../shared/mkdir.php\";\n  include dirname(__FILE__) . \"/../shared/http_variables.php\";\n  include dirname(__FILE__) . \"/../shared/console.php\";\n  include dirname(__FILE__) . \"/get_data.php\";\n\n  header('Content-Type: application/json; charset=utf-8');\n  header('X-Content-Type-Options: nosniff');\n\n  $http_variables = new HttpVariables();\n\n  $mkdir = new Mkdir($http_variables);\n  $mkdir->set();\n\n  $get_data = new GetData();\n\n  (function () use ($mkdir, $http_variables, $get_data) {\n      $console = new Console();\n\n      $files = $http_variables->files('result_data');\n      $target_dirname = $http_variables->get('target_dirname');\n      $target_data_path = realpath('../record/data/' . $target_dirname);\n      $data_map_json_path = $target_data_path . '/data_map.json';\n      $console->log($data_map_json_path);\n      $data_map = $get_data->get_target_data_map($data_map_json_path, $target_dirname);\n      $data_map['listen_num'] += 1;\n      file_put_contents($data_map_json_path, json_encode($data_map, JSON_PRETTY_PRINT | JSON_UNESCAPED_UNICODE));\n\n      $input = $files['tmp_name'];\n      $output = $files['name'] . \".json\";\n\n      if (move_uploaded_file($input, \"./\" . $mkdir->full_data_dir_name . \"/\" . $output)) {\n          echo json_encode(['message' => 'Created listen result data.']);\n      } else {\n          http_response_code(405);\n      }\n  })();\n\n","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"<?php\n  declare(strict_types=1);\n\n  error_reporting(E_ALL);\n\n  include dirname(__FILE__) . \"/../shared/mkdir.php\";\n  include dirname(__FILE__) . \"/../shared/http_variables.php\";\n  include dirname(__FILE__) . \"/../shared/console.php\";\n  include dirname(__FILE__) . \"/get_data.php\";\n\n  header('Content-Type: application/json; charset=utf-8');\n  header('X-Content-Type-Options: nosniff');\n\n  $http_variables = new HttpVariables();\n\n  $mkdir = new Mkdir($http_variables);\n  $mkdir->set();\n\n  $get_data = new GetData();\n\n  (function () use ($mkdir, $http_variables, $get_data) {\n      $console = new Console();\n\n      $files = $http_variables->files('result_data');\n      $target_dirname = $http_variables->get('target_dirname');\n      $target_data_path = realpath('../record/data/' . $target_dirname);\n      $data_map_json_path = $target_data_path . '/data_map.json';\n      $console->log($data_map_json_path);\n      $data_map = $get_data->get_target_data_map($data_map_json_path, $target_dirname);\n      $data_map['listen_num'] += 1;\n      file_put_contents($data_map_json_path, json_encode($data_map, JSON_PRETTY_PRINT | JSON_UNESCAPED_UNICODE));\n\n      $input = $files['tmp_name'];\n      $output = $files['name'] . \".json\";\n\n      if (move_uploaded_file($input, \"./\" . $mkdir->full_data_dir_name . \"/\" . $output)) {\n          echo json_encode(['message' => 'Created listen result data.']);\n      } else {\n          http_response_code(405);\n      }\n  })();\n\n","href":null}],"language":"plain text"}},{"object":"block","id":"15b9bbc0-a641-4a06-84ad-b0abc013d17b","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2023-01-01T01:08:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"JSerは即時関数を使いがち。PHPは慣れていると言いつつも飛び道具程度にしか書いてなかったので、マジでこの部分危ないよ！とかのマサカリ大歓迎です。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"JSerは即時関数を使いがち。PHPは慣れていると言いつつも飛び道具程度にしか書いてなかったので、マジでこの部分危ないよ！とかのマサカリ大歓迎です。","href":null}],"color":"default"}},{"object":"block","id":"546f6e32-a904-4f19-b2e1-90a5de50b46e","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2023-01-01T01:08:00.000Z","last_edited_time":"2023-01-01T01:08:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"歴戦のPHPerの元で PHP だけ書く修行をしたいが、PHPで飯を食うつもりが今の所ないのでこの有様です。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"歴戦のPHPerの元で PHP だけ書く修行をしたいが、PHPで飯を食うつもりが今の所ないのでこの有様です。","href":null}],"color":"default"}},{"object":"block","id":"91f67bec-5119-42e7-9459-fa8304648434","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2023-01-02T13:52:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"振り返り","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"振り返り","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"d643f5c5-5ab6-4157-a0ce-103a97529c66","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2023-01-01T01:09:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"Next.jsをVercel以外でホスティングするのはやはり面倒だった。若干つまづいた所もあったが、適当なCDNに乗せるみたいなイメージでできた。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Next.jsをVercel以外でホスティングするのはやはり面倒だった。若干つまづいた所もあったが、適当なCDNに乗せるみたいなイメージでできた。","href":null}],"color":"default"}},{"object":"block","id":"58cd1492-8544-43a9-9354-faef4f9e3804","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"反省としては、同時接続の件数がかなりあったのに対応出来ていなかったところがある。収集できたデータを確認していると同時にリクエストが飛んできて書き込みに失敗し、破損しているデータがちらほらあった(これらはクラウドソーシングで再発注した)ので、やっぱりDB使おうねという気持ちになった。DBまわりのセキュリティ勉強する。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"反省としては、同時接続の件数がかなりあったのに対応出来ていなかったところがある。収集できたデータを確認していると同時にリクエストが飛んできて書き込みに失敗し、破損しているデータがちらほらあった(これらはクラウドソーシングで再発注した)ので、やっぱりDB使おうねという気持ちになった。DBまわりのセキュリティ勉強する。","href":null}],"color":"default"}},{"object":"block","id":"b0f9094b-f37c-4efd-b2ea-742f222049ae","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2023-01-02T13:52:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"heading_1","heading_1":{"rich_text":[{"type":"text","text":{"content":"卒論執筆を支えた技術","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"卒論執筆を支えた技術","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"e9a25016-9f27-4c99-a68d-e3c2365dd48d","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"ついでに卒論執筆環境についてもちょっとだけ工夫したので書く。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"ついでに卒論執筆環境についてもちょっとだけ工夫したので書く。","href":null}],"color":"default"}},{"object":"block","id":"81873a50-21fd-4728-abb5-357f47005dca","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2023-01-01T01:10:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"卒論はTeXで書いた。周りはCloud LaTeXなどのオンラインのサービスを使っていたが、研究室で色々あってWiFiがダウンしたりしたときに面倒なのでローカルに環境を作った。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"卒論はTeXで書いた。周りはCloud LaTeXなどのオンラインのサービスを使っていたが、研究室で色々あってWiFiがダウンしたりしたときに面倒なのでローカルに環境を作った。","href":null}],"color":"default"}},{"object":"block","id":"7bab91bf-fd3e-4c22-b29e-dc6d363770d4","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2023-01-01T01:10:00.000Z","last_edited_time":"2023-01-01T01:10:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"ただ、ローカルだとデータが吹っ飛ぶと絶望する羽目になるので、GitHub上にプライベートリポジトリを作って適当な進捗が出る度にpushするようにした。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"ただ、ローカルだとデータが吹っ飛ぶと絶望する羽目になるので、GitHub上にプライベートリポジトリを作って適当な進捗が出る度にpushするようにした。","href":null}],"color":"default"}},{"object":"block","id":"4230dba7-9ae3-4a57-af05-c55a6f538eac","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2023-01-02T13:52:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"環境構築","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"環境構築","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"a8c38921-5259-46d4-b11e-03f95630fad2","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2023-01-01T01:10:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"mac勢なので学部2回生の頃ぐらいにとりあえずTexShopをインストールしてた。ちなみにこれに付属してるエディタは卒論では使ってない。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"mac勢なので学部2回生の頃ぐらいにとりあえずTexShopをインストールしてた。ちなみにこれに付属してるエディタは卒論では使ってない。","href":null}],"color":"default"}},{"object":"block","id":"538fdb7a-6b2d-48bf-983d-726518a4145b","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2023-01-01T01:10:00.000Z","last_edited_time":"2023-01-01T01:10:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"おわり。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"おわり。","href":null}],"color":"default"}},{"object":"block","id":"4c1eb75b-49e6-43d6-ab3e-c6b4c68560de","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2023-01-02T13:52:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"エディタで論文のプレビューを見れるようにする","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"エディタで論文のプレビューを見れるようにする","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"e8ee5f40-0ce8-430d-a32a-7404a77a0e78","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2023-01-01T01:10:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"こっちに注力してよかった。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"こっちに注力してよかった。","href":null}],"color":"default"}},{"object":"block","id":"f53985cb-2f90-45f7-9c23-30b15f6e5c23","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"エディタには慣れているVSCodeを使っていた。VSCodeにはLaTeXにむけた拡張機能で","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"エディタには慣れているVSCodeを使っていた。VSCodeにはLaTeXにむけた拡張機能で","href":null},{"type":"text","text":{"content":"LaTeX-Workshop","link":{"url":"https://github.com/James-Yu/LaTeX-Workshop"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"LaTeX-Workshop","href":"https://github.com/James-Yu/LaTeX-Workshop"},{"type":"text","text":{"content":"というものがある。これを導入すると、VSCode上でTeXのビルド・プレビューを行いながら執筆出来る上にコード補完とかもある全部のせセットなのでかなり捗った。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"というものがある。これを導入すると、VSCode上でTeXのビルド・プレビューを行いながら執筆出来る上にコード補完とかもある全部のせセットなのでかなり捗った。","href":null}],"color":"default"}},{"object":"block","id":"a3b1fd7e-2577-4c2c-93bf-1745f3ce669f","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2023-01-02T13:52:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"添削にむけた差分強調","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"添削にむけた差分強調","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"2ccf9a39-8693-4670-a3d7-4ccd364ee84b","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"卒論を書くにあたって指導教員から添削をもらってマシな論文に近づけていくと思うが、その際に何度も繰り返し添削を受けることになると思う。そこで、前回修正した点と今回修正した点が一目見て分かるようにすると教員側に対して優しいのでやった(というかこれをやらないと添削してもらえなかった)。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"卒論を書くにあたって指導教員から添削をもらってマシな論文に近づけていくと思うが、その際に何度も繰り返し添削を受けることになると思う。そこで、前回修正した点と今回修正した点が一目見て分かるようにすると教員側に対して優しいのでやった(というかこれをやらないと添削してもらえなかった)。","href":null}],"color":"default"}},{"object":"block","id":"f1a8a110-ec52-48b0-9359-e38e2a3c8b0a","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"latexdiffを用いると、訂正前と後の差分をまとめたTeXファイルを吐き出させることが出来る。また、gitを使ってバージョン管理している場合はlatexdiff-vcのgitオプションを使用すると、コミットごとに差分をまとめることが出来る。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"latexdiffを用いると、訂正前と後の差分をまとめたTeXファイルを吐き出させることが出来る。また、gitを使ってバージョン管理している場合はlatexdiff-vcのgitオプションを使用すると、コミットごとに差分をまとめることが出来る。","href":null}],"color":"default"}},{"object":"block","id":"3bbbfabd-53ee-4dbf-8823-a51bc6dadfa6","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"これで解決！といきたいところだが、僕の手元のLaTeX環境ではlatexdiff(latexdiff-vc)を利用して吐き出したファイルのfigureが表示されない(多分","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"これで解決！といきたいところだが、僕の手元のLaTeX環境ではlatexdiff(latexdiff-vc)を利用して吐き出したファイルのfigureが表示されない(多分","href":null},{"type":"text","text":{"content":"\\\\usepackage[dvipdfmx]{color}","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"\\\\usepackage[dvipdfmx]{color}","href":null},{"type":"text","text":{"content":" 加えたら表示されるが、めちゃくちゃ焦ってて気づいてなかった)とか、文章に謎の改行が入るとか、差分を出すには若干手間だったので断念した。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" 加えたら表示されるが、めちゃくちゃ焦ってて気づいてなかった)とか、文章に謎の改行が入るとか、差分を出すには若干手間だったので断念した。","href":null}],"color":"default"}},{"object":"block","id":"f811162d-490f-455b-b5fe-842d88bb121f","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"代わりにhomebrewでインストール出来る","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"代わりにhomebrewでインストール出来る","href":null},{"type":"text","text":{"content":"diff-pdf","link":{"url":"https://formulae.brew.sh/formula/diff-pdf"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"diff-pdf","href":"https://formulae.brew.sh/formula/diff-pdf"},{"type":"text","text":{"content":"でPDFの差分を見つつ、一つ一つ手作業で変更箇所の色を変えた。TeXで色を変更したい箇所は","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"でPDFの差分を見つつ、一つ一つ手作業で変更箇所の色を変えた。TeXで色を変更したい箇所は","href":null},{"type":"text","text":{"content":"\\\\newcommand{\\\\red}[1]{\\\\color{red}#1\\\\color{black}}","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"\\\\newcommand{\\\\red}[1]{\\\\color{red}#1\\\\color{black}}","href":null},{"type":"text","text":{"content":"のようなマクロを使って","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"のようなマクロを使って","href":null},{"type":"text","text":{"content":"\\\\red{変更箇所}","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"\\\\red{変更箇所}","href":null},{"type":"text","text":{"content":"のように書いた。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"のように書いた。","href":null}],"color":"default"}},{"object":"block","id":"e61864a8-c130-43d9-ae95-6b6bc75e1bb6","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2023-01-02T13:52:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"heading_1","heading_1":{"rich_text":[{"type":"text","text":{"content":"他に卒論を支えたもの","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"他に卒論を支えたもの","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"ffe2837a-d030-481c-80d5-caa28f6dbfa5","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"技術以外の話。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"技術以外の話。","href":null}],"color":"default"}},{"object":"block","id":"77ab3319-d1c9-49c3-8849-f0966deeba1d","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2023-01-02T13:52:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"睡眠・運動","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"睡眠・運動","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"a769b152-da9a-4b74-9596-729b2ca69cda","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"睡眠１番大事。徹夜はやめたほうがいい。20代は無敵！とか思ってたが意外と簡単に身体は壊れる。パソコンは雑に扱っても壊れないが、人は雑に扱うと壊れるって昔大学の先輩が言っていた。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"睡眠１番大事。徹夜はやめたほうがいい。20代は無敵！とか思ってたが意外と簡単に身体は壊れる。パソコンは雑に扱っても壊れないが、人は雑に扱うと壊れるって昔大学の先輩が言っていた。","href":null}],"color":"default"}},{"object":"block","id":"e9100917-24f3-4978-a1cb-d752a297314d","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"とりあえずなんか不調だなと思ったら寝るようにした。人とコミュニケーション取りたくない(Slackやメールの返信がめちゃくちゃしんどいとか)って思った時はかなり疲弊しているので寝ろ！みたいなのをどっかで見た気がする。これを実践していた。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"とりあえずなんか不調だなと思ったら寝るようにした。人とコミュニケーション取りたくない(Slackやメールの返信がめちゃくちゃしんどいとか)って思った時はかなり疲弊しているので寝ろ！みたいなのをどっかで見た気がする。これを実践していた。","href":null}],"color":"default"}},{"object":"block","id":"7aad2bb6-48e3-4034-a333-850be2d29899","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"あとは運動すると眠くなりやすいのでおすすめ。合法的に暴れられるのでストレス発散にもなって心身に良い。余裕のあるときは駅前のエニタイムフィットネスに１日おきぐらいで通ってた。別にステマではないけど24時間開いてるのが助かった。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"あとは運動すると眠くなりやすいのでおすすめ。合法的に暴れられるのでストレス発散にもなって心身に良い。余裕のあるときは駅前のエニタイムフィットネスに１日おきぐらいで通ってた。別にステマではないけど24時間開いてるのが助かった。","href":null}],"color":"default"}},{"object":"block","id":"03af5df7-f3a2-43d6-adbb-73ba28d66884","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2023-01-02T13:52:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"人と話す・飯食いに行く","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"人と話す・飯食いに行く","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"f15149a2-9751-46ef-bf0c-a0c88f0b90c5","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"1人で作業してて煮詰まったら人と他愛もないことを話すと良かった。話すために研究室に行って卒論書いてたり、友達とdiscordで作業したりしてた。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"1人で作業してて煮詰まったら人と他愛もないことを話すと良かった。話すために研究室に行って卒論書いてたり、友達とdiscordで作業したりしてた。","href":null}],"color":"default"}},{"object":"block","id":"5a04301d-601d-46ec-8212-01c96adcb3c0","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2023-01-01T01:11:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"人と飯食いに行くのも気分転換によくやってた。飯の際の酒は程々に。2日酔いになると詰む。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"人と飯食いに行くのも気分転換によくやってた。飯の際の酒は程々に。2日酔いになると詰む。","href":null}],"color":"default"}},{"object":"block","id":"16c1a7cb-65d2-41d2-bd7e-b0f9d725d942","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2023-01-02T13:52:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"(適度な)ゲーム","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"(適度な)ゲーム","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"1ad8bc4c-01f1-493b-9b75-4b3e21585b8c","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2023-01-01T01:11:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"適度ならかなり良い気分転換になった。友達と本気でApexのランクマッチやったり、最近配信するのを勧められて暇なときに","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"適度ならかなり良い気分転換になった。友達と本気でApexのランクマッチやったり、最近配信するのを勧められて暇なときに","href":null},{"type":"text","text":{"content":"Twitchで配信","link":{"url":"https://www.twitch.tv/sc_shuta13"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Twitchで配信","href":"https://www.twitch.tv/sc_shuta13"},{"type":"text","text":{"content":"してみたりしてる。やるなら気軽にはじめられて1人でも他の人と一緒でも出来るゲームがおすすめ。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"してみたりしてる。やるなら気軽にはじめられて1人でも他の人と一緒でも出来るゲームがおすすめ。","href":null}],"color":"default"}},{"object":"block","id":"b882fc28-0b46-4bde-828a-6be4843f02b8","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2023-01-01T01:11:00.000Z","last_edited_time":"2023-01-01T01:11:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"のめり込むとこちらも飲酒と同様に詰む。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"のめり込むとこちらも飲酒と同様に詰む。","href":null}],"color":"default"}},{"object":"block","id":"7310010c-fe92-4d88-b72b-e5cc925b017f","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2023-01-02T13:52:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"(適度な)散財","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"(適度な)散財","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"e8af74ed-0911-4938-84dd-6aea35b024f2","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"こっちも適度にやると気分転換になる。何回かミスってクレカ上限突破グレンラガンした。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"こっちも適度にやると気分転換になる。何回かミスってクレカ上限突破グレンラガンした。","href":null}],"color":"default"}},{"object":"block","id":"e57f4bac-0e99-45e8-811d-ac138845cc72","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"最近だと春服とかメンズコスメとか、春から始まる生活で便利そうなものとかを爆買いした。買い物しながら大学卒業後の生活を想像すると楽しい。卒論で煮詰まったら自転車操業にならないように気をつけつつ、好きなものに対しての散財はぜひ。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"最近だと春服とかメンズコスメとか、春から始まる生活で便利そうなものとかを爆買いした。買い物しながら大学卒業後の生活を想像すると楽しい。卒論で煮詰まったら自転車操業にならないように気をつけつつ、好きなものに対しての散財はぜひ。","href":null}],"color":"default"}},{"object":"block","id":"7a6f2578-b04d-402a-a677-a224e5fb3243","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2023-01-02T13:52:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"heading_1","heading_1":{"rich_text":[{"type":"text","text":{"content":"おわりに","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"おわりに","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"5398c8d3-6c1a-4778-a9f2-ff1965e3ec56","parent":{"type":"page_id","page_id":"d67bc50b-8c28-4a09-b15f-1d9bcaf9cf80"},"created_time":"2022-12-31T16:47:00.000Z","last_edited_time":"2022-12-31T16:47:00.000Z","created_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"last_edited_by":{"object":"user","id":"a4bdc144-e774-42ba-b088-ef9316f60cad"},"has_children":false,"archived":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"とにかく卒論の修正と発表会頑張る。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"とにかく卒論の修正と発表会頑張る。","href":null}],"color":"default"}}]}}},"__N_SSG":true}